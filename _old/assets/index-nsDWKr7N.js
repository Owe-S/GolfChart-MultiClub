(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Bt,Jt;function $t(){return{geminiUrl:Bt,vertexUrl:Jt}}function Yt(n,e,t,o){var s,l;if(!(n!=null&&n.baseUrl)){const a=$t();return e?(s=a.vertexUrl)!==null&&s!==void 0?s:t:(l=a.geminiUrl)!==null&&l!==void 0?l:o}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class X{}function E(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(o,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const l=e[s];return l!=null?String(l):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function r(n,e,t){for(let l=0;l<e.length-1;l++){const a=e[l];if(a.endsWith("[]")){const u=a.slice(0,-2);if(!(u in n))if(Array.isArray(t))n[u]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(n[u])){const c=n[u];if(Array.isArray(t))for(let d=0;d<c.length;d++){const f=c[d];r(f,e.slice(l+1),t[d])}else for(const d of c)r(d,e.slice(l+1),t)}return}else if(a.endsWith("[0]")){const u=a.slice(0,-3);u in n||(n[u]=[{}]);const c=n[u];r(c[0],e.slice(l+1),t);return}(!n[a]||typeof n[a]!="object")&&(n[a]={}),n=n[a]}const o=e[e.length-1],s=n[o];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${o}`)}else o==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[o]=t}function i(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let o=0;o<e.length;o++){if(typeof n!="object"||n===null)return t;const s=e[o];if(s.endsWith("[]")){const l=s.slice(0,-2);if(l in n){const a=n[l];return Array.isArray(a)?a.map(u=>i(u,e.slice(o+1),t)):t}else return t}else n=n[s]}return n}catch(o){if(o instanceof TypeError)return t;throw o}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ue(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Kt(n){const e={},t=i(n,["operationName"]);t!=null&&r(e,["operationName"],t);const o=i(n,["resourceName"]);return o!=null&&r(e,["_url","resourceName"],o),e}function Wt(n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const o=i(n,["metadata"]);o!=null&&r(e,["metadata"],o);const s=i(n,["done"]);s!=null&&r(e,["done"],s);const l=i(n,["error"]);l!=null&&r(e,["error"],l);const a=i(n,["response","generateVideoResponse"]);return a!=null&&r(e,["response"],Xt(a)),e}function zt(n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const o=i(n,["metadata"]);o!=null&&r(e,["metadata"],o);const s=i(n,["done"]);s!=null&&r(e,["done"],s);const l=i(n,["error"]);l!=null&&r(e,["error"],l);const a=i(n,["response"]);return a!=null&&r(e,["response"],Qt(a)),e}function Xt(n){const e={},t=i(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>Zt(a))),r(e,["generatedVideos"],l)}const o=i(n,["raiMediaFilteredCount"]);o!=null&&r(e,["raiMediaFilteredCount"],o);const s=i(n,["raiMediaFilteredReasons"]);return s!=null&&r(e,["raiMediaFilteredReasons"],s),e}function Qt(n){const e={},t=i(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>Ot(a))),r(e,["generatedVideos"],l)}const o=i(n,["raiMediaFilteredCount"]);o!=null&&r(e,["raiMediaFilteredCount"],o);const s=i(n,["raiMediaFilteredReasons"]);return s!=null&&r(e,["raiMediaFilteredReasons"],s),e}function Zt(n){const e={},t=i(n,["_self"]);return t!=null&&r(e,["video"],no(t)),e}function Ot(n){const e={},t=i(n,["_self"]);return t!=null&&r(e,["video"],to(t)),e}function jt(n){const e={},t=i(n,["operationName"]);return t!=null&&r(e,["_url","operationName"],t),e}function eo(n){const e={},t=i(n,["operationName"]);return t!=null&&r(e,["_url","operationName"],t),e}function no(n){const e={},t=i(n,["video","uri"]);t!=null&&r(e,["uri"],t);const o=i(n,["video","encodedVideo"]);o!=null&&r(e,["videoBytes"],Ue(o));const s=i(n,["encoding"]);return s!=null&&r(e,["mimeType"],s),e}function to(n){const e={},t=i(n,["gcsUri"]);t!=null&&r(e,["uri"],t);const o=i(n,["bytesBase64Encoded"]);o!=null&&r(e,["videoBytes"],Ue(o));const s=i(n,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Je;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Je||(Je={}));var $e;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})($e||($e={}));var Y;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Y||(Y={}));var Ye;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Ye||(Ye={}));var Ke;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Ke||(Ke={}));var We;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(We||(We={}));var ze;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(ze||(ze={}));var Xe;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Xe||(Xe={}));var Qe;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Qe||(Qe={}));var Ze;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Ze||(Ze={}));var Oe;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(Oe||(Oe={}));var je;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(je||(je={}));var en;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(en||(en={}));var nn;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(nn||(nn={}));var tn;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(tn||(tn={}));var me;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(me||(me={}));var on;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(on||(on={}));var Me;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Me||(Me={}));var sn;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(sn||(sn={}));var rn;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(rn||(rn={}));var ln;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V"})(ln||(ln={}));var an;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(an||(an={}));var un;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(un||(un={}));var dn;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(dn||(dn={}));var cn;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(cn||(cn={}));var fn;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(fn||(fn={}));var pn;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(pn||(pn={}));var mn;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(mn||(mn={}));var hn;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(hn||(hn={}));var gn;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(gn||(gn={}));var yn;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(yn||(yn={}));var Tn;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Tn||(Tn={}));var Cn;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Cn||(Cn={}));var En;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(En||(En={}));var _n;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(_n||(_n={}));var vn;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(vn||(vn={}));var Sn;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(Sn||(Sn={}));var In;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(In||(In={}));var An;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(An||(An={}));var Rn;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Rn||(Rn={}));var Mn;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(Mn||(Mn={}));var Pn;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Pn||(Pn={}));var Nn;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Nn||(Nn={}));var wn;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(wn||(wn={}));var Dn;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Dn||(Dn={}));var kn;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(kn||(kn={}));var xn;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(xn||(xn={}));var Ln;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(Ln||(Ln={}));var Q;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Q||(Q={}));class Pe{constructor(e){const t={};for(const o of e.headers.entries())t[o[0]]=o[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class re{get text(){var e,t,o,s,l,a,u,c;if(((s=(o=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",f=!1;const p=[];for(const m of(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[h,g]of Object.entries(m))h!=="text"&&h!=="thought"&&(g!==null||g!==void 0)&&p.push(h);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;f=!0,d+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?d:void 0}get data(){var e,t,o,s,l,a,u,c;if(((s=(o=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const f=[];for(const p of(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[m,h]of Object.entries(p))m!=="inlineData"&&(h!==null||h!==void 0)&&f.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(d+=atob(p.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,t,o,s,l,a,u,c;if(((s=(o=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var e,t,o,s,l,a,u,c,d;if(((s=(o=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,o,s,l,a,u,c,d;if(((s=(o=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.output}}class Un{}class qn{}class oo{}class io{}class so{}class ro{}class Vn{}class Fn{}class Gn{}class lo{}class he{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const o=new he;let s;const l=e;return t?s=zt(l):s=Wt(l),Object.assign(o,s),o}}class bn{}class Hn{}class Bn{}class ao{}class uo{}class co{}class Jn{}class fo{get text(){var e,t,o;let s="",l=!1;const a=[];for(const u of(o=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&o!==void 0?o:[]){for(const[c,d]of Object.entries(u))c!=="text"&&c!=="thought"&&d!==null&&a.push(c);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;l=!0,s+=u.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?s:void 0}get data(){var e,t,o;let s="";const l=[];for(const a of(o=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&o!==void 0?o:[]){for(const[u,c]of Object.entries(a))u!=="inlineData"&&c!==null&&l.push(u);a.inlineData&&typeof a.inlineData.data=="string"&&(s+=atob(a.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class po{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function N(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function at(n,e){const t=N(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function ut(n){return Array.isArray(n)?n.map(e=>ge(e)):[ge(n)]}function ge(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function dt(n){const e=ge(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function ct(n){const e=ge(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function $n(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function ft(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>$n(e)):[$n(n)]}function Ne(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function Yn(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function Kn(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function q(n){if(n==null)throw new Error("ContentUnion is required");return Ne(n)?n:{role:"user",parts:ft(n)}}function qe(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const o=q(t);return o.parts&&o.parts.length>0&&o.parts[0].text!==void 0?[o.parts[0].text]:[]});if(n.isVertexAI()){const t=q(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>q(t)):[q(e)]}function F(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(Yn(n)||Kn(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[q(n)]}const e=[],t=[],o=Ne(n[0]);for(const s of n){const l=Ne(s);if(l!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(s);else{if(Yn(s)||Kn(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return o||e.push({role:"user",parts:ft(t)}),e}function mo(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(o=>o!=="null");if(t.length===1)e.type=Object.values(Y).includes(t[0].toUpperCase())?t[0].toUpperCase():Y.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const o of t)e.anyOf.push({type:Object.values(Y).includes(o.toUpperCase())?o.toUpperCase():Y.TYPE_UNSPECIFIED})}}function O(n){const e={},t=["items"],o=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=n.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(e.nullable=!0,n=l[1]):l[1].type==="null"&&(e.nullable=!0,n=l[0])),n.type instanceof Array&&mo(n.type,e);for(const[a,u]of Object.entries(n))if(u!=null)if(a=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(Y).includes(u.toUpperCase())?u.toUpperCase():Y.TYPE_UNSPECIFIED}else if(t.includes(a))e[a]=O(u);else if(o.includes(a)){const c=[];for(const d of u){if(d.type=="null"){e.nullable=!0;continue}c.push(O(d))}e[a]=c}else if(s.includes(a)){const c={};for(const[d,f]of Object.entries(u))c[d]=O(f);e[a]=c}else{if(a==="additionalProperties")continue;e[a]=u}return e}function Ve(n){return O(n)}function Fe(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Ge(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function te(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=O(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=O(e.response));return n}function oe(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function ho(n,e,t,o=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===o;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function $(n,e){if(typeof e!="string")throw new Error("name must be a string");return ho(n,e,"cachedContents")}function pt(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function K(n){return Ue(n)}function go(n){return n!=null&&typeof n=="object"&&"name"in n}function yo(n){return n!=null&&typeof n=="object"&&"video"in n}function To(n){return n!=null&&typeof n=="object"&&"uri"in n}function mt(n){var e;let t;if(go(n)&&(t=n.name),!(To(n)&&(t=n.uri,t===void 0))&&!(yo(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function ht(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function gt(n){for(const e of["models","tunedModels","publisherModels"])if(Co(n,e))return n[e];return[]}function Co(n,e){return n!==null&&typeof n=="object"&&e in n}function Eo(n,e={}){const t=n,o={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(o.responseJsonSchema=t.outputSchema),e.behavior&&(o.behavior=e.behavior),{functionDeclarations:[o]}}function _o(n,e={}){const t=[],o=new Set;for(const s of n){const l=s.name;if(o.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);o.add(l);const a=Eo(s,e);a.functionDeclarations&&t.push(...a.functionDeclarations)}return{functionDeclarations:t}}function yt(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const o=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,s=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(s>0||o!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(o>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function vo(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Tt(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const s=t.inlinedResponses;if(!Array.isArray(s)||s.length===0)return n;let l=!1;for(const a of s){if(typeof a!="object"||a===null)continue;const c=a.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){l=!0;break}}return l&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function ie(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function Ct(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function So(n){const e={},t=i(n,["responsesFile"]);t!=null&&r(e,["fileName"],t);const o=i(n,["inlinedResponses","inlinedResponses"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(a=>Oo(a))),r(e,["inlinedResponses"],l)}const s=i(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>a)),r(e,["inlinedEmbedContentResponses"],l)}return e}function Io(n){const e={},t=i(n,["predictionsFormat"]);t!=null&&r(e,["format"],t);const o=i(n,["gcsDestination","outputUriPrefix"]);o!=null&&r(e,["gcsUri"],o);const s=i(n,["bigqueryDestination","outputUri"]);return s!=null&&r(e,["bigqueryUri"],s),e}function Ao(n){const e={},t=i(n,["format"]);t!=null&&r(e,["predictionsFormat"],t);const o=i(n,["gcsUri"]);o!=null&&r(e,["gcsDestination","outputUriPrefix"],o);const s=i(n,["bigqueryUri"]);if(s!=null&&r(e,["bigqueryDestination","outputUri"],s),i(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(i(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(i(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function le(n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const o=i(n,["metadata","displayName"]);o!=null&&r(e,["displayName"],o);const s=i(n,["metadata","state"]);s!=null&&r(e,["state"],Ct(s));const l=i(n,["metadata","createTime"]);l!=null&&r(e,["createTime"],l);const a=i(n,["metadata","endTime"]);a!=null&&r(e,["endTime"],a);const u=i(n,["metadata","updateTime"]);u!=null&&r(e,["updateTime"],u);const c=i(n,["metadata","model"]);c!=null&&r(e,["model"],c);const d=i(n,["metadata","output"]);return d!=null&&r(e,["dest"],So(Tt(d))),e}function we(n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const o=i(n,["displayName"]);o!=null&&r(e,["displayName"],o);const s=i(n,["state"]);s!=null&&r(e,["state"],Ct(s));const l=i(n,["error"]);l!=null&&r(e,["error"],l);const a=i(n,["createTime"]);a!=null&&r(e,["createTime"],a);const u=i(n,["startTime"]);u!=null&&r(e,["startTime"],u);const c=i(n,["endTime"]);c!=null&&r(e,["endTime"],c);const d=i(n,["updateTime"]);d!=null&&r(e,["updateTime"],d);const f=i(n,["model"]);f!=null&&r(e,["model"],f);const p=i(n,["inputConfig"]);p!=null&&r(e,["src"],Ro(p));const m=i(n,["outputConfig"]);return m!=null&&r(e,["dest"],Io(Tt(m))),e}function Ro(n){const e={},t=i(n,["instancesFormat"]);t!=null&&r(e,["format"],t);const o=i(n,["gcsSource","uris"]);o!=null&&r(e,["gcsUri"],o);const s=i(n,["bigquerySource","inputUri"]);return s!=null&&r(e,["bigqueryUri"],s),e}function Mo(n,e){const t={};if(i(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(i(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(i(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const o=i(e,["fileName"]);o!=null&&r(t,["fileName"],o);const s=i(e,["inlinedRequests"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>Zo(n,a))),r(t,["requests","requests"],l)}return t}function Po(n){const e={},t=i(n,["format"]);t!=null&&r(e,["instancesFormat"],t);const o=i(n,["gcsUri"]);o!=null&&r(e,["gcsSource","uris"],o);const s=i(n,["bigqueryUri"]);if(s!=null&&r(e,["bigquerySource","inputUri"],s),i(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(i(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function No(n){const e={};if(i(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=i(n,["data"]);t!=null&&r(e,["data"],t);const o=i(n,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function wo(n,e){const t={},o=i(e,["name"]);return o!=null&&r(t,["_url","name"],ie(n,o)),t}function Do(n,e){const t={},o=i(e,["name"]);return o!=null&&r(t,["_url","name"],ie(n,o)),t}function ko(n){const e={},t=i(n,["content"]);t!=null&&r(e,["content"],t);const o=i(n,["citationMetadata"]);o!=null&&r(e,["citationMetadata"],xo(o));const s=i(n,["tokenCount"]);s!=null&&r(e,["tokenCount"],s);const l=i(n,["finishReason"]);l!=null&&r(e,["finishReason"],l);const a=i(n,["urlContextMetadata"]);a!=null&&r(e,["urlContextMetadata"],a);const u=i(n,["avgLogprobs"]);u!=null&&r(e,["avgLogprobs"],u);const c=i(n,["groundingMetadata"]);c!=null&&r(e,["groundingMetadata"],c);const d=i(n,["index"]);d!=null&&r(e,["index"],d);const f=i(n,["logprobsResult"]);f!=null&&r(e,["logprobsResult"],f);const p=i(n,["safetyRatings"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(h=>h)),r(e,["safetyRatings"],m)}return e}function xo(n){const e={},t=i(n,["citationSources"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>s)),r(e,["citations"],o)}return e}function Et(n){const e={},t=i(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>si(l))),r(e,["parts"],s)}const o=i(n,["role"]);return o!=null&&r(e,["role"],o),e}function Lo(n,e){const t={},o=i(n,["displayName"]);if(e!==void 0&&o!=null&&r(e,["batch","displayName"],o),i(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function Uo(n,e){const t={},o=i(n,["displayName"]);e!==void 0&&o!=null&&r(e,["displayName"],o);const s=i(n,["dest"]);return e!==void 0&&s!=null&&r(e,["outputConfig"],Ao(vo(s))),t}function Wn(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["src"]);s!=null&&r(t,["batch","inputConfig"],Mo(n,yt(n,s)));const l=i(e,["config"]);return l!=null&&Lo(l,t),t}function qo(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["model"],N(n,o));const s=i(e,["src"]);s!=null&&r(t,["inputConfig"],Po(yt(n,s)));const l=i(e,["config"]);return l!=null&&Uo(l,t),t}function Vo(n,e){const t={},o=i(n,["displayName"]);return e!==void 0&&o!=null&&r(e,["batch","displayName"],o),t}function Ae(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["src"]);s!=null&&r(t,["batch","inputConfig"],$o(n,s));const l=i(e,["config"]);return l!=null&&Vo(l,t),t}function Fo(n,e){const t={},o=i(e,["name"]);return o!=null&&r(t,["_url","name"],ie(n,o)),t}function Go(n,e){const t={},o=i(e,["name"]);return o!=null&&r(t,["_url","name"],ie(n,o)),t}function bo(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["name"]);o!=null&&r(e,["name"],o);const s=i(n,["done"]);s!=null&&r(e,["done"],s);const l=i(n,["error"]);return l!=null&&r(e,["error"],l),e}function Ho(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["name"]);o!=null&&r(e,["name"],o);const s=i(n,["done"]);s!=null&&r(e,["done"],s);const l=i(n,["error"]);return l!=null&&r(e,["error"],l),e}function Bo(n,e){const t={},o=i(e,["contents"]);if(o!=null){let l=qe(n,o);Array.isArray(l)&&(l=l.map(a=>a)),r(t,["requests[]","request","content"],l)}const s=i(e,["config"]);return s!=null&&r(t,["_self"],Jo(s,t)),t}function Jo(n,e){const t={},o=i(n,["taskType"]);e!==void 0&&o!=null&&r(e,["requests[]","taskType"],o);const s=i(n,["title"]);e!==void 0&&s!=null&&r(e,["requests[]","title"],s);const l=i(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&r(e,["requests[]","outputDimensionality"],l),i(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(i(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function $o(n,e){const t={},o=i(e,["fileName"]);o!=null&&r(t,["file_name"],o);const s=i(e,["inlinedRequests"]);return s!=null&&r(t,["requests"],Bo(n,s)),t}function Yo(n){const e={};if(i(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=i(n,["fileUri"]);t!=null&&r(e,["fileUri"],t);const o=i(n,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function Ko(n,e,t){const o={},s=i(e,["systemInstruction"]);t!==void 0&&s!=null&&r(t,["systemInstruction"],Et(q(s)));const l=i(e,["temperature"]);l!=null&&r(o,["temperature"],l);const a=i(e,["topP"]);a!=null&&r(o,["topP"],a);const u=i(e,["topK"]);u!=null&&r(o,["topK"],u);const c=i(e,["candidateCount"]);c!=null&&r(o,["candidateCount"],c);const d=i(e,["maxOutputTokens"]);d!=null&&r(o,["maxOutputTokens"],d);const f=i(e,["stopSequences"]);f!=null&&r(o,["stopSequences"],f);const p=i(e,["responseLogprobs"]);p!=null&&r(o,["responseLogprobs"],p);const m=i(e,["logprobs"]);m!=null&&r(o,["logprobs"],m);const h=i(e,["presencePenalty"]);h!=null&&r(o,["presencePenalty"],h);const g=i(e,["frequencyPenalty"]);g!=null&&r(o,["frequencyPenalty"],g);const y=i(e,["seed"]);y!=null&&r(o,["seed"],y);const T=i(e,["responseMimeType"]);T!=null&&r(o,["responseMimeType"],T);const S=i(e,["responseSchema"]);S!=null&&r(o,["responseSchema"],Ve(S));const v=i(e,["responseJsonSchema"]);if(v!=null&&r(o,["responseJsonSchema"],v),i(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(i(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=i(e,["safetySettings"]);if(t!==void 0&&_!=null){let x=_;Array.isArray(x)&&(x=x.map(b=>ri(b))),r(t,["safetySettings"],x)}const I=i(e,["tools"]);if(t!==void 0&&I!=null){let x=oe(I);Array.isArray(x)&&(x=x.map(b=>li(te(b)))),r(t,["tools"],x)}const R=i(e,["toolConfig"]);if(t!==void 0&&R!=null&&r(t,["toolConfig"],R),i(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=i(e,["cachedContent"]);t!==void 0&&M!=null&&r(t,["cachedContent"],$(n,M));const P=i(e,["responseModalities"]);P!=null&&r(o,["responseModalities"],P);const U=i(e,["mediaResolution"]);U!=null&&r(o,["mediaResolution"],U);const A=i(e,["speechConfig"]);if(A!=null&&r(o,["speechConfig"],Fe(A)),i(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const w=i(e,["thinkingConfig"]);w!=null&&r(o,["thinkingConfig"],w);const V=i(e,["imageConfig"]);return V!=null&&r(o,["imageConfig"],V),o}function Wo(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["candidates"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>ko(d))),r(e,["candidates"],c)}const s=i(n,["modelVersion"]);s!=null&&r(e,["modelVersion"],s);const l=i(n,["promptFeedback"]);l!=null&&r(e,["promptFeedback"],l);const a=i(n,["responseId"]);a!=null&&r(e,["responseId"],a);const u=i(n,["usageMetadata"]);return u!=null&&r(e,["usageMetadata"],u),e}function zo(n,e){const t={},o=i(e,["name"]);return o!=null&&r(t,["_url","name"],ie(n,o)),t}function Xo(n,e){const t={},o=i(e,["name"]);return o!=null&&r(t,["_url","name"],ie(n,o)),t}function Qo(n){const e={},t=i(n,["timeRangeFilter"]);if(t!=null&&r(e,["timeRangeFilter"],t),i(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function Zo(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["request","model"],N(n,o));const s=i(e,["contents"]);if(s!=null){let a=F(s);Array.isArray(a)&&(a=a.map(u=>Et(u))),r(t,["request","contents"],a)}const l=i(e,["config"]);return l!=null&&r(t,["request","generationConfig"],Ko(n,l,i(t,["request"],{}))),t}function Oo(n){const e={},t=i(n,["response"]);t!=null&&r(e,["response"],Wo(t));const o=i(n,["error"]);return o!=null&&r(e,["error"],o),e}function jo(n,e){const t={},o=i(n,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(n,["pageToken"]);if(e!==void 0&&s!=null&&r(e,["_query","pageToken"],s),i(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function ei(n,e){const t={},o=i(n,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(n,["pageToken"]);e!==void 0&&s!=null&&r(e,["_query","pageToken"],s);const l=i(n,["filter"]);return e!==void 0&&l!=null&&r(e,["_query","filter"],l),t}function ni(n){const e={},t=i(n,["config"]);return t!=null&&jo(t,e),e}function ti(n){const e={},t=i(n,["config"]);return t!=null&&ei(t,e),e}function oi(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(n,["operations"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>le(a))),r(e,["batchJobs"],l)}return e}function ii(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(n,["batchPredictionJobs"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>we(a))),r(e,["batchJobs"],l)}return e}function si(n){const e={},t=i(n,["videoMetadata"]);t!=null&&r(e,["videoMetadata"],t);const o=i(n,["thought"]);o!=null&&r(e,["thought"],o);const s=i(n,["inlineData"]);s!=null&&r(e,["inlineData"],No(s));const l=i(n,["fileData"]);l!=null&&r(e,["fileData"],Yo(l));const a=i(n,["thoughtSignature"]);a!=null&&r(e,["thoughtSignature"],a);const u=i(n,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=i(n,["codeExecutionResult"]);c!=null&&r(e,["codeExecutionResult"],c);const d=i(n,["executableCode"]);d!=null&&r(e,["executableCode"],d);const f=i(n,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=i(n,["text"]);return p!=null&&r(e,["text"],p),e}function ri(n){const e={};if(i(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=i(n,["category"]);t!=null&&r(e,["category"],t);const o=i(n,["threshold"]);return o!=null&&r(e,["threshold"],o),e}function li(n){const e={},t=i(n,["functionDeclarations"]);if(t!=null){let c=t;Array.isArray(c)&&(c=c.map(d=>d)),r(e,["functionDeclarations"],c)}if(i(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=i(n,["googleSearch"]);o!=null&&r(e,["googleSearch"],Qo(o));const s=i(n,["googleSearchRetrieval"]);if(s!=null&&r(e,["googleSearchRetrieval"],s),i(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(i(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=i(n,["urlContext"]);l!=null&&r(e,["urlContext"],l);const a=i(n,["computerUse"]);a!=null&&r(e,["computerUse"],a);const u=i(n,["codeExecution"]);return u!=null&&r(e,["codeExecution"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var W;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(W||(W={}));class fe{constructor(e,t,o,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,o,s)}init(e,t,o){var s,l;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let a={config:{}};!o||Object.keys(o).length===0?a={config:{}}:typeof o=="object"?a=Object.assign({},o):a=o,a.config&&(a.config.pageToken=t.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(l=(s=a.config)===null||s===void 0?void 0:s.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ai extends X{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{var o,s;if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");if(!(t.src.inlinedRequests!==void 0))return this.createEmbeddingsInternal(t);const u=this.createInlinedEmbedContentRequest(t),c=u.path,d=u.body,f=Ae(this.apiClient,t)._query||{};return this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()).then(m=>le(m))},this.list=async(t={})=>new fe(W.PAGED_ITEM_BATCH_JOBS,o=>this.listInternal(o),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=Wn(this.apiClient,e),o=t._url,s=E("{model}:batchGenerateContent",o),u=t.batch.inputConfig.requests,c=u.requests,d=[];for(const f of c){const p=Object.assign({},f);if(p.systemInstruction){const m=p.systemInstruction;delete p.systemInstruction;const h=p.request;h.systemInstruction=m,p.request=h}d.push(p)}return u.requests=d,delete t.config,delete t._url,delete t._query,{path:s,body:t}}createInlinedEmbedContentRequest(e){const t=Ae(this.apiClient,e),o=t._url,s=E("{model}:asyncBatchEmbedContent",o),u=t.batch.inputConfig.requests,c=u.requests,d=[];delete u.config;for(const f of c){const p=Object.assign({},f),m=p.request;for(const h in p)h!=="request"&&(m[h]=p[h],delete p[h]);d.push(p)}return u.requests=d,delete t.config,delete t._url,delete t._query,{path:s,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const o=t?Object.assign({},t):{},s=Date.now().toString();if(o.displayName||(o.displayName=`genaiBatchJob_${s}`),o.dest===void 0){const l=this.getGcsUri(e),a=this.getBigqueryUri(e);if(l)l.endsWith(".jsonl")?o.dest=`${l.slice(0,-6)}/dest`:o.dest=`${l}_dest_${s}`;else if(a)o.dest=`${a}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return o}async createInternal(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=qo(this.apiClient,e);return u=E("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>we(f))}else{const d=Wn(this.apiClient,e);return u=E("{model}:batchGenerateContent",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>le(f))}}async createEmbeddingsInternal(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ae(this.apiClient,e);return l=E("{model}:asyncBatchEmbedContent",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>le(c))}}async get(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Xo(this.apiClient,e);return u=E("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>we(f))}else{const d=zo(this.apiClient,e);return u=E("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>le(f))}}async cancel(e){var t,o,s,l;let a="",u={};if(this.apiClient.isVertexAI()){const c=Do(this.apiClient,e);a=E("batchPredictionJobs/{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}else{const c=wo(this.apiClient,e);a=E("batches/{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ti(e);return u=E("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=ii(f),m=new Jn;return Object.assign(m,p),m})}else{const d=ni(e);return u=E("batches",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=oi(f),m=new Jn;return Object.assign(m,p),m})}}async delete(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Go(this.apiClient,e);return u=E("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>Ho(f))}else{const d=Fo(this.apiClient,e);return u=E("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>bo(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ui(n){const e={};if(i(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=i(n,["data"]);t!=null&&r(e,["data"],t);const o=i(n,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function zn(n){const e={},t=i(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>Ni(l))),r(e,["parts"],s)}const o=i(n,["role"]);return o!=null&&r(e,["role"],o),e}function di(n,e){const t={},o=i(n,["ttl"]);e!==void 0&&o!=null&&r(e,["ttl"],o);const s=i(n,["expireTime"]);e!==void 0&&s!=null&&r(e,["expireTime"],s);const l=i(n,["displayName"]);e!==void 0&&l!=null&&r(e,["displayName"],l);const a=i(n,["contents"]);if(e!==void 0&&a!=null){let f=F(a);Array.isArray(f)&&(f=f.map(p=>zn(p))),r(e,["contents"],f)}const u=i(n,["systemInstruction"]);e!==void 0&&u!=null&&r(e,["systemInstruction"],zn(q(u)));const c=i(n,["tools"]);if(e!==void 0&&c!=null){let f=c;Array.isArray(f)&&(f=f.map(p=>wi(p))),r(e,["tools"],f)}const d=i(n,["toolConfig"]);if(e!==void 0&&d!=null&&r(e,["toolConfig"],d),i(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function ci(n,e){const t={},o=i(n,["ttl"]);e!==void 0&&o!=null&&r(e,["ttl"],o);const s=i(n,["expireTime"]);e!==void 0&&s!=null&&r(e,["expireTime"],s);const l=i(n,["displayName"]);e!==void 0&&l!=null&&r(e,["displayName"],l);const a=i(n,["contents"]);if(e!==void 0&&a!=null){let p=F(a);Array.isArray(p)&&(p=p.map(m=>m)),r(e,["contents"],p)}const u=i(n,["systemInstruction"]);e!==void 0&&u!=null&&r(e,["systemInstruction"],q(u));const c=i(n,["tools"]);if(e!==void 0&&c!=null){let p=c;Array.isArray(p)&&(p=p.map(m=>Di(m))),r(e,["tools"],p)}const d=i(n,["toolConfig"]);e!==void 0&&d!=null&&r(e,["toolConfig"],d);const f=i(n,["kmsKeyName"]);return e!==void 0&&f!=null&&r(e,["encryption_spec","kmsKeyName"],f),t}function fi(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["model"],at(n,o));const s=i(e,["config"]);return s!=null&&di(s,t),t}function pi(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["model"],at(n,o));const s=i(e,["config"]);return s!=null&&ci(s,t),t}function mi(n,e){const t={},o=i(e,["name"]);return o!=null&&r(t,["_url","name"],$(n,o)),t}function hi(n,e){const t={},o=i(e,["name"]);return o!=null&&r(t,["_url","name"],$(n,o)),t}function gi(n){const e={},t=i(n,["sdkHttpResponse"]);return t!=null&&r(e,["sdkHttpResponse"],t),e}function yi(n){const e={},t=i(n,["sdkHttpResponse"]);return t!=null&&r(e,["sdkHttpResponse"],t),e}function Ti(n){const e={};if(i(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=i(n,["fileUri"]);t!=null&&r(e,["fileUri"],t);const o=i(n,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function Ci(n){const e={};if(i(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=i(n,["description"]);t!=null&&r(e,["description"],t);const o=i(n,["name"]);o!=null&&r(e,["name"],o);const s=i(n,["parameters"]);s!=null&&r(e,["parameters"],s);const l=i(n,["parametersJsonSchema"]);l!=null&&r(e,["parametersJsonSchema"],l);const a=i(n,["response"]);a!=null&&r(e,["response"],a);const u=i(n,["responseJsonSchema"]);return u!=null&&r(e,["responseJsonSchema"],u),e}function Ei(n,e){const t={},o=i(e,["name"]);return o!=null&&r(t,["_url","name"],$(n,o)),t}function _i(n,e){const t={},o=i(e,["name"]);return o!=null&&r(t,["_url","name"],$(n,o)),t}function vi(n){const e={},t=i(n,["timeRangeFilter"]);if(t!=null&&r(e,["timeRangeFilter"],t),i(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function Si(n,e){const t={},o=i(n,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(n,["pageToken"]);return e!==void 0&&s!=null&&r(e,["_query","pageToken"],s),t}function Ii(n,e){const t={},o=i(n,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(n,["pageToken"]);return e!==void 0&&s!=null&&r(e,["_query","pageToken"],s),t}function Ai(n){const e={},t=i(n,["config"]);return t!=null&&Si(t,e),e}function Ri(n){const e={},t=i(n,["config"]);return t!=null&&Ii(t,e),e}function Mi(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(n,["cachedContents"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>a)),r(e,["cachedContents"],l)}return e}function Pi(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(n,["cachedContents"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>a)),r(e,["cachedContents"],l)}return e}function Ni(n){const e={},t=i(n,["videoMetadata"]);t!=null&&r(e,["videoMetadata"],t);const o=i(n,["thought"]);o!=null&&r(e,["thought"],o);const s=i(n,["inlineData"]);s!=null&&r(e,["inlineData"],ui(s));const l=i(n,["fileData"]);l!=null&&r(e,["fileData"],Ti(l));const a=i(n,["thoughtSignature"]);a!=null&&r(e,["thoughtSignature"],a);const u=i(n,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=i(n,["codeExecutionResult"]);c!=null&&r(e,["codeExecutionResult"],c);const d=i(n,["executableCode"]);d!=null&&r(e,["executableCode"],d);const f=i(n,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=i(n,["text"]);return p!=null&&r(e,["text"],p),e}function wi(n){const e={},t=i(n,["functionDeclarations"]);if(t!=null){let c=t;Array.isArray(c)&&(c=c.map(d=>d)),r(e,["functionDeclarations"],c)}if(i(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=i(n,["googleSearch"]);o!=null&&r(e,["googleSearch"],vi(o));const s=i(n,["googleSearchRetrieval"]);if(s!=null&&r(e,["googleSearchRetrieval"],s),i(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(i(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=i(n,["urlContext"]);l!=null&&r(e,["urlContext"],l);const a=i(n,["computerUse"]);a!=null&&r(e,["computerUse"],a);const u=i(n,["codeExecution"]);return u!=null&&r(e,["codeExecution"],u),e}function Di(n){const e={},t=i(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(m=>Ci(m))),r(e,["functionDeclarations"],p)}const o=i(n,["retrieval"]);o!=null&&r(e,["retrieval"],o);const s=i(n,["googleSearch"]);s!=null&&r(e,["googleSearch"],s);const l=i(n,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],l);const a=i(n,["enterpriseWebSearch"]);a!=null&&r(e,["enterpriseWebSearch"],a);const u=i(n,["googleMaps"]);u!=null&&r(e,["googleMaps"],u);const c=i(n,["urlContext"]);c!=null&&r(e,["urlContext"],c);const d=i(n,["computerUse"]);d!=null&&r(e,["computerUse"],d);const f=i(n,["codeExecution"]);return f!=null&&r(e,["codeExecution"],f),e}function ki(n,e){const t={},o=i(n,["ttl"]);e!==void 0&&o!=null&&r(e,["ttl"],o);const s=i(n,["expireTime"]);return e!==void 0&&s!=null&&r(e,["expireTime"],s),t}function xi(n,e){const t={},o=i(n,["ttl"]);e!==void 0&&o!=null&&r(e,["ttl"],o);const s=i(n,["expireTime"]);return e!==void 0&&s!=null&&r(e,["expireTime"],s),t}function Li(n,e){const t={},o=i(e,["name"]);o!=null&&r(t,["_url","name"],$(n,o));const s=i(e,["config"]);return s!=null&&ki(s,t),t}function Ui(n,e){const t={},o=i(e,["name"]);o!=null&&r(t,["_url","name"],$(n,o));const s=i(e,["config"]);return s!=null&&xi(s,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qi extends X{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new fe(W.PAGED_ITEM_CACHED_CONTENTS,o=>this.listInternal(o),await this.listInternal(t),t)}async create(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=pi(this.apiClient,e);return u=E("cachedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>f)}else{const d=fi(this.apiClient,e);return u=E("cachedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>f)}}async get(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=_i(this.apiClient,e);return u=E("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>f)}else{const d=Ei(this.apiClient,e);return u=E("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>f)}}async delete(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=hi(this.apiClient,e);return u=E("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=yi(f),m=new Hn;return Object.assign(m,p),m})}else{const d=mi(this.apiClient,e);return u=E("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=gi(f),m=new Hn;return Object.assign(m,p),m})}}async update(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ui(this.apiClient,e);return u=E("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>f)}else{const d=Li(this.apiClient,e);return u=E("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>f)}}async listInternal(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ri(e);return u=E("cachedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=Pi(f),m=new Bn;return Object.assign(m,p),m})}else{const d=Ai(e);return u=E("cachedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=Mi(f),m=new Bn;return Object.assign(m,p),m})}}}function Xn(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],o=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function D(n){return this instanceof D?(this.v=n,this):new D(n)}function j(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=t.apply(n,e||[]),s,l=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",a),s[Symbol.asyncIterator]=function(){return this},s;function a(h){return function(g){return Promise.resolve(g).then(h,p)}}function u(h,g){o[h]&&(s[h]=function(y){return new Promise(function(T,S){l.push([h,y,T,S])>1||c(h,y)})},g&&(s[h]=g(s[h])))}function c(h,g){try{d(o[h](g))}catch(y){m(l[0][3],y)}}function d(h){h.value instanceof D?Promise.resolve(h.value.v).then(f,p):m(l[0][2],h)}function f(h){c("next",h)}function p(h){c("throw",h)}function m(h,g){h(g),l.shift(),l.length&&c(l[0][0],l[0][1])}}function ue(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Xn=="function"?Xn(n):n[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(l){t[l]=n[l]&&function(a){return new Promise(function(u,c){a=n[l](a),s(u,c,a.done,a.value)})}}function s(l,a,u,c){Promise.resolve(c).then(function(d){l({value:d,done:u})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vi(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:_t(t)}function _t(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function Fi(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Qn(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let o=0;for(;o<t;)if(n[o].role==="user")e.push(n[o]),o++;else{const s=[];let l=!0;for(;o<t&&n[o].role==="model";)s.push(n[o]),l&&!_t(n[o])&&(l=!1),o++;l?e.push(...s):e.pop()}return e}class Gi{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new bi(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class bi{constructor(e,t,o,s={},l=[]){this.apiClient=e,this.modelsModule=t,this.model=o,this.config=s,this.history=l,this.sendPromise=Promise.resolve(),Fi(l)}async sendMessage(e){var t;await this.sendPromise;const o=q(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(o),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var l,a,u;const c=await s,d=(a=(l=c.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content,f=c.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let m=[];f!=null&&(m=(u=f.slice(p))!==null&&u!==void 0?u:[]);const h=d?[d]:[];this.recordHistory(o,h,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const o=q(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(o),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const l=await s;return this.processStreamResponse(l,o)}getHistory(e=!1){const t=e?Qn(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var o,s;return j(this,arguments,function*(){var a,u,c,d;const f=[];try{for(var p=!0,m=ue(e),h;h=yield D(m.next()),a=h.done,!a;p=!0){d=h.value,p=!1;const g=d;if(Vi(g)){const y=(s=(o=g.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content;y!==void 0&&f.push(y)}yield yield D(g)}}catch(g){u={error:g}}finally{try{!p&&!a&&(c=m.return)&&(yield D(c.call(m)))}finally{if(u)throw u.error}}this.recordHistory(t,f)})}recordHistory(e,t,o){let s=[];t.length>0&&t.every(l=>l.role!==void 0)?s=t:s.push({role:"model",parts:[]}),o&&o.length>0?this.history.push(...Qn(o)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Te extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Te.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Hi(n){const e={},t=i(n,["file"]);return t!=null&&r(e,["file"],t),e}function Bi(n){const e={},t=i(n,["sdkHttpResponse"]);return t!=null&&r(e,["sdkHttpResponse"],t),e}function Ji(n){const e={},t=i(n,["name"]);return t!=null&&r(e,["_url","file"],mt(t)),e}function $i(n){const e={},t=i(n,["sdkHttpResponse"]);return t!=null&&r(e,["sdkHttpResponse"],t),e}function Yi(n){const e={},t=i(n,["name"]);return t!=null&&r(e,["_url","file"],mt(t)),e}function Ki(n,e){const t={},o=i(n,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(n,["pageToken"]);return e!==void 0&&s!=null&&r(e,["_query","pageToken"],s),t}function Wi(n){const e={},t=i(n,["config"]);return t!=null&&Ki(t,e),e}function zi(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(n,["files"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>a)),r(e,["files"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xi extends X{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new fe(W.PAGED_ITEM_FILES,o=>this.listInternal(o),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Wi(e);return l=E("files",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=zi(c),f=new ao;return Object.assign(f,d),f})}}async createInternal(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Hi(e);return l=E("upload/v1beta/files",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=Bi(c),f=new uo;return Object.assign(f,d),f})}}async get(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Yi(e);return l=E("files/{file}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async delete(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ji(e);return l=E("files/{file}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=$i(c),f=new co;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pe(n){const e={};if(i(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=i(n,["data"]);t!=null&&r(e,["data"],t);const o=i(n,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function Qi(n){const e={},t=i(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>ds(l))),r(e,["parts"],s)}const o=i(n,["role"]);return o!=null&&r(e,["role"],o),e}function Zi(n){const e={};if(i(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=i(n,["fileUri"]);t!=null&&r(e,["fileUri"],t);const o=i(n,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function Oi(n){const e={};if(i(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=i(n,["description"]);t!=null&&r(e,["description"],t);const o=i(n,["name"]);o!=null&&r(e,["name"],o);const s=i(n,["parameters"]);s!=null&&r(e,["parameters"],s);const l=i(n,["parametersJsonSchema"]);l!=null&&r(e,["parametersJsonSchema"],l);const a=i(n,["response"]);a!=null&&r(e,["response"],a);const u=i(n,["responseJsonSchema"]);return u!=null&&r(e,["responseJsonSchema"],u),e}function ji(n){const e={},t=i(n,["modelSelectionConfig"]);t!=null&&r(e,["modelConfig"],t);const o=i(n,["audioTimestamp"]);o!=null&&r(e,["audioTimestamp"],o);const s=i(n,["candidateCount"]);s!=null&&r(e,["candidateCount"],s);const l=i(n,["enableAffectiveDialog"]);l!=null&&r(e,["enableAffectiveDialog"],l);const a=i(n,["frequencyPenalty"]);a!=null&&r(e,["frequencyPenalty"],a);const u=i(n,["logprobs"]);u!=null&&r(e,["logprobs"],u);const c=i(n,["maxOutputTokens"]);c!=null&&r(e,["maxOutputTokens"],c);const d=i(n,["mediaResolution"]);d!=null&&r(e,["mediaResolution"],d);const f=i(n,["presencePenalty"]);f!=null&&r(e,["presencePenalty"],f);const p=i(n,["responseJsonSchema"]);p!=null&&r(e,["responseJsonSchema"],p);const m=i(n,["responseLogprobs"]);m!=null&&r(e,["responseLogprobs"],m);const h=i(n,["responseMimeType"]);h!=null&&r(e,["responseMimeType"],h);const g=i(n,["responseModalities"]);g!=null&&r(e,["responseModalities"],g);const y=i(n,["responseSchema"]);y!=null&&r(e,["responseSchema"],y);const T=i(n,["routingConfig"]);T!=null&&r(e,["routingConfig"],T);const S=i(n,["seed"]);S!=null&&r(e,["seed"],S);const v=i(n,["speechConfig"]);v!=null&&r(e,["speechConfig"],vt(v));const _=i(n,["stopSequences"]);_!=null&&r(e,["stopSequences"],_);const I=i(n,["temperature"]);I!=null&&r(e,["temperature"],I);const R=i(n,["thinkingConfig"]);R!=null&&r(e,["thinkingConfig"],R);const M=i(n,["topK"]);M!=null&&r(e,["topK"],M);const P=i(n,["topP"]);return P!=null&&r(e,["topP"],P),e}function es(n){const e={},t=i(n,["timeRangeFilter"]);if(t!=null&&r(e,["timeRangeFilter"],t),i(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function ns(n,e){const t={},o=i(n,["generationConfig"]);e!==void 0&&o!=null&&r(e,["setup","generationConfig"],o);const s=i(n,["responseModalities"]);e!==void 0&&s!=null&&r(e,["setup","generationConfig","responseModalities"],s);const l=i(n,["temperature"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","temperature"],l);const a=i(n,["topP"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","topP"],a);const u=i(n,["topK"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topK"],u);const c=i(n,["maxOutputTokens"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","maxOutputTokens"],c);const d=i(n,["mediaResolution"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","mediaResolution"],d);const f=i(n,["seed"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","seed"],f);const p=i(n,["speechConfig"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","speechConfig"],Ge(p));const m=i(n,["thinkingConfig"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","thinkingConfig"],m);const h=i(n,["enableAffectiveDialog"]);e!==void 0&&h!=null&&r(e,["setup","generationConfig","enableAffectiveDialog"],h);const g=i(n,["systemInstruction"]);e!==void 0&&g!=null&&r(e,["setup","systemInstruction"],Qi(q(g)));const y=i(n,["tools"]);if(e!==void 0&&y!=null){let M=oe(y);Array.isArray(M)&&(M=M.map(P=>fs(te(P)))),r(e,["setup","tools"],M)}const T=i(n,["sessionResumption"]);e!==void 0&&T!=null&&r(e,["setup","sessionResumption"],cs(T));const S=i(n,["inputAudioTranscription"]);e!==void 0&&S!=null&&r(e,["setup","inputAudioTranscription"],S);const v=i(n,["outputAudioTranscription"]);e!==void 0&&v!=null&&r(e,["setup","outputAudioTranscription"],v);const _=i(n,["realtimeInputConfig"]);e!==void 0&&_!=null&&r(e,["setup","realtimeInputConfig"],_);const I=i(n,["contextWindowCompression"]);e!==void 0&&I!=null&&r(e,["setup","contextWindowCompression"],I);const R=i(n,["proactivity"]);return e!==void 0&&R!=null&&r(e,["setup","proactivity"],R),t}function ts(n,e){const t={},o=i(n,["generationConfig"]);e!==void 0&&o!=null&&r(e,["setup","generationConfig"],ji(o));const s=i(n,["responseModalities"]);e!==void 0&&s!=null&&r(e,["setup","generationConfig","responseModalities"],s);const l=i(n,["temperature"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","temperature"],l);const a=i(n,["topP"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","topP"],a);const u=i(n,["topK"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topK"],u);const c=i(n,["maxOutputTokens"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","maxOutputTokens"],c);const d=i(n,["mediaResolution"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","mediaResolution"],d);const f=i(n,["seed"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","seed"],f);const p=i(n,["speechConfig"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","speechConfig"],vt(Ge(p)));const m=i(n,["thinkingConfig"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","thinkingConfig"],m);const h=i(n,["enableAffectiveDialog"]);e!==void 0&&h!=null&&r(e,["setup","generationConfig","enableAffectiveDialog"],h);const g=i(n,["systemInstruction"]);e!==void 0&&g!=null&&r(e,["setup","systemInstruction"],q(g));const y=i(n,["tools"]);if(e!==void 0&&y!=null){let M=oe(y);Array.isArray(M)&&(M=M.map(P=>ps(te(P)))),r(e,["setup","tools"],M)}const T=i(n,["sessionResumption"]);e!==void 0&&T!=null&&r(e,["setup","sessionResumption"],T);const S=i(n,["inputAudioTranscription"]);e!==void 0&&S!=null&&r(e,["setup","inputAudioTranscription"],S);const v=i(n,["outputAudioTranscription"]);e!==void 0&&v!=null&&r(e,["setup","outputAudioTranscription"],v);const _=i(n,["realtimeInputConfig"]);e!==void 0&&_!=null&&r(e,["setup","realtimeInputConfig"],_);const I=i(n,["contextWindowCompression"]);e!==void 0&&I!=null&&r(e,["setup","contextWindowCompression"],I);const R=i(n,["proactivity"]);return e!==void 0&&R!=null&&r(e,["setup","proactivity"],R),t}function os(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["setup","model"],N(n,o));const s=i(e,["config"]);return s!=null&&r(t,["config"],ns(s,t)),t}function is(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["setup","model"],N(n,o));const s=i(e,["config"]);return s!=null&&r(t,["config"],ts(s,t)),t}function ss(n){const e={},t=i(n,["musicGenerationConfig"]);return t!=null&&r(e,["musicGenerationConfig"],t),e}function rs(n){const e={},t=i(n,["weightedPrompts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>s)),r(e,["weightedPrompts"],o)}return e}function ls(n){const e={},t=i(n,["media"]);if(t!=null){let d=ut(t);Array.isArray(d)&&(d=d.map(f=>pe(f))),r(e,["mediaChunks"],d)}const o=i(n,["audio"]);o!=null&&r(e,["audio"],pe(ct(o)));const s=i(n,["audioStreamEnd"]);s!=null&&r(e,["audioStreamEnd"],s);const l=i(n,["video"]);l!=null&&r(e,["video"],pe(dt(l)));const a=i(n,["text"]);a!=null&&r(e,["text"],a);const u=i(n,["activityStart"]);u!=null&&r(e,["activityStart"],u);const c=i(n,["activityEnd"]);return c!=null&&r(e,["activityEnd"],c),e}function as(n){const e={},t=i(n,["media"]);if(t!=null){let d=ut(t);Array.isArray(d)&&(d=d.map(f=>f)),r(e,["mediaChunks"],d)}const o=i(n,["audio"]);o!=null&&r(e,["audio"],ct(o));const s=i(n,["audioStreamEnd"]);s!=null&&r(e,["audioStreamEnd"],s);const l=i(n,["video"]);l!=null&&r(e,["video"],dt(l));const a=i(n,["text"]);a!=null&&r(e,["text"],a);const u=i(n,["activityStart"]);u!=null&&r(e,["activityStart"],u);const c=i(n,["activityEnd"]);return c!=null&&r(e,["activityEnd"],c),e}function us(n){const e={},t=i(n,["setupComplete"]);t!=null&&r(e,["setupComplete"],t);const o=i(n,["serverContent"]);o!=null&&r(e,["serverContent"],o);const s=i(n,["toolCall"]);s!=null&&r(e,["toolCall"],s);const l=i(n,["toolCallCancellation"]);l!=null&&r(e,["toolCallCancellation"],l);const a=i(n,["usageMetadata"]);a!=null&&r(e,["usageMetadata"],ms(a));const u=i(n,["goAway"]);u!=null&&r(e,["goAway"],u);const c=i(n,["sessionResumptionUpdate"]);return c!=null&&r(e,["sessionResumptionUpdate"],c),e}function ds(n){const e={},t=i(n,["videoMetadata"]);t!=null&&r(e,["videoMetadata"],t);const o=i(n,["thought"]);o!=null&&r(e,["thought"],o);const s=i(n,["inlineData"]);s!=null&&r(e,["inlineData"],pe(s));const l=i(n,["fileData"]);l!=null&&r(e,["fileData"],Zi(l));const a=i(n,["thoughtSignature"]);a!=null&&r(e,["thoughtSignature"],a);const u=i(n,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=i(n,["codeExecutionResult"]);c!=null&&r(e,["codeExecutionResult"],c);const d=i(n,["executableCode"]);d!=null&&r(e,["executableCode"],d);const f=i(n,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=i(n,["text"]);return p!=null&&r(e,["text"],p),e}function cs(n){const e={},t=i(n,["handle"]);if(t!=null&&r(e,["handle"],t),i(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function vt(n){const e={},t=i(n,["voiceConfig"]);if(t!=null&&r(e,["voiceConfig"],t),i(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const o=i(n,["languageCode"]);return o!=null&&r(e,["languageCode"],o),e}function fs(n){const e={},t=i(n,["functionDeclarations"]);if(t!=null){let c=t;Array.isArray(c)&&(c=c.map(d=>d)),r(e,["functionDeclarations"],c)}if(i(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=i(n,["googleSearch"]);o!=null&&r(e,["googleSearch"],es(o));const s=i(n,["googleSearchRetrieval"]);if(s!=null&&r(e,["googleSearchRetrieval"],s),i(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(i(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=i(n,["urlContext"]);l!=null&&r(e,["urlContext"],l);const a=i(n,["computerUse"]);a!=null&&r(e,["computerUse"],a);const u=i(n,["codeExecution"]);return u!=null&&r(e,["codeExecution"],u),e}function ps(n){const e={},t=i(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(m=>Oi(m))),r(e,["functionDeclarations"],p)}const o=i(n,["retrieval"]);o!=null&&r(e,["retrieval"],o);const s=i(n,["googleSearch"]);s!=null&&r(e,["googleSearch"],s);const l=i(n,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],l);const a=i(n,["enterpriseWebSearch"]);a!=null&&r(e,["enterpriseWebSearch"],a);const u=i(n,["googleMaps"]);u!=null&&r(e,["googleMaps"],u);const c=i(n,["urlContext"]);c!=null&&r(e,["urlContext"],c);const d=i(n,["computerUse"]);d!=null&&r(e,["computerUse"],d);const f=i(n,["codeExecution"]);return f!=null&&r(e,["codeExecution"],f),e}function ms(n){const e={},t=i(n,["promptTokenCount"]);t!=null&&r(e,["promptTokenCount"],t);const o=i(n,["cachedContentTokenCount"]);o!=null&&r(e,["cachedContentTokenCount"],o);const s=i(n,["candidatesTokenCount"]);s!=null&&r(e,["responseTokenCount"],s);const l=i(n,["toolUsePromptTokenCount"]);l!=null&&r(e,["toolUsePromptTokenCount"],l);const a=i(n,["thoughtsTokenCount"]);a!=null&&r(e,["thoughtsTokenCount"],a);const u=i(n,["totalTokenCount"]);u!=null&&r(e,["totalTokenCount"],u);const c=i(n,["promptTokensDetails"]);if(c!=null){let h=c;Array.isArray(h)&&(h=h.map(g=>g)),r(e,["promptTokensDetails"],h)}const d=i(n,["cacheTokensDetails"]);if(d!=null){let h=d;Array.isArray(h)&&(h=h.map(g=>g)),r(e,["cacheTokensDetails"],h)}const f=i(n,["candidatesTokensDetails"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(g=>g)),r(e,["responseTokensDetails"],h)}const p=i(n,["toolUsePromptTokensDetails"]);if(p!=null){let h=p;Array.isArray(h)&&(h=h.map(g=>g)),r(e,["toolUsePromptTokensDetails"],h)}const m=i(n,["trafficType"]);return m!=null&&r(e,["trafficType"],m),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hs(n){const e={};if(i(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=i(n,["data"]);t!=null&&r(e,["data"],t);const o=i(n,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function gs(n){const e={},t=i(n,["content"]);t!=null&&r(e,["content"],t);const o=i(n,["citationMetadata"]);o!=null&&r(e,["citationMetadata"],ys(o));const s=i(n,["tokenCount"]);s!=null&&r(e,["tokenCount"],s);const l=i(n,["finishReason"]);l!=null&&r(e,["finishReason"],l);const a=i(n,["urlContextMetadata"]);a!=null&&r(e,["urlContextMetadata"],a);const u=i(n,["avgLogprobs"]);u!=null&&r(e,["avgLogprobs"],u);const c=i(n,["groundingMetadata"]);c!=null&&r(e,["groundingMetadata"],c);const d=i(n,["index"]);d!=null&&r(e,["index"],d);const f=i(n,["logprobsResult"]);f!=null&&r(e,["logprobsResult"],f);const p=i(n,["safetyRatings"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(h=>h)),r(e,["safetyRatings"],m)}return e}function ys(n){const e={},t=i(n,["citationSources"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>s)),r(e,["citations"],o)}return e}function Ts(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["contents"]);if(s!=null){let l=F(s);Array.isArray(l)&&(l=l.map(a=>a)),r(t,["contents"],l)}return t}function Cs(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["tokensInfo"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>l)),r(e,["tokensInfo"],s)}return e}function Es(n){const e={},t=i(n,["values"]);t!=null&&r(e,["values"],t);const o=i(n,["statistics"]);return o!=null&&r(e,["statistics"],_s(o)),e}function _s(n){const e={},t=i(n,["truncated"]);t!=null&&r(e,["truncated"],t);const o=i(n,["token_count"]);return o!=null&&r(e,["tokenCount"],o),e}function Ce(n){const e={},t=i(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>Ar(l))),r(e,["parts"],s)}const o=i(n,["role"]);return o!=null&&r(e,["role"],o),e}function vs(n){const e={},t=i(n,["controlType"]);t!=null&&r(e,["controlType"],t);const o=i(n,["enableControlImageComputation"]);return o!=null&&r(e,["computeControl"],o),e}function Ss(n){const e={};if(i(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(i(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(i(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Is(n,e){const t={},o=i(n,["systemInstruction"]);e!==void 0&&o!=null&&r(e,["systemInstruction"],q(o));const s=i(n,["tools"]);if(e!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(u=>Mt(u))),r(e,["tools"],a)}const l=i(n,["generationConfig"]);return e!==void 0&&l!=null&&r(e,["generationConfig"],pr(l)),t}function As(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["contents"]);if(s!=null){let a=F(s);Array.isArray(a)&&(a=a.map(u=>Ce(u))),r(t,["contents"],a)}const l=i(e,["config"]);return l!=null&&Ss(l),t}function Rs(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["contents"]);if(s!=null){let a=F(s);Array.isArray(a)&&(a=a.map(u=>u)),r(t,["contents"],a)}const l=i(e,["config"]);return l!=null&&Is(l,t),t}function Ms(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["totalTokens"]);o!=null&&r(e,["totalTokens"],o);const s=i(n,["cachedContentTokenCount"]);return s!=null&&r(e,["cachedContentTokenCount"],s),e}function Ps(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["totalTokens"]);return o!=null&&r(e,["totalTokens"],o),e}function Ns(n,e){const t={},o=i(e,["model"]);return o!=null&&r(t,["_url","name"],N(n,o)),t}function ws(n,e){const t={},o=i(e,["model"]);return o!=null&&r(t,["_url","name"],N(n,o)),t}function Ds(n){const e={},t=i(n,["sdkHttpResponse"]);return t!=null&&r(e,["sdkHttpResponse"],t),e}function ks(n){const e={},t=i(n,["sdkHttpResponse"]);return t!=null&&r(e,["sdkHttpResponse"],t),e}function xs(n,e){const t={},o=i(n,["outputGcsUri"]);e!==void 0&&o!=null&&r(e,["parameters","storageUri"],o);const s=i(n,["negativePrompt"]);e!==void 0&&s!=null&&r(e,["parameters","negativePrompt"],s);const l=i(n,["numberOfImages"]);e!==void 0&&l!=null&&r(e,["parameters","sampleCount"],l);const a=i(n,["aspectRatio"]);e!==void 0&&a!=null&&r(e,["parameters","aspectRatio"],a);const u=i(n,["guidanceScale"]);e!==void 0&&u!=null&&r(e,["parameters","guidanceScale"],u);const c=i(n,["seed"]);e!==void 0&&c!=null&&r(e,["parameters","seed"],c);const d=i(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&r(e,["parameters","safetySetting"],d);const f=i(n,["personGeneration"]);e!==void 0&&f!=null&&r(e,["parameters","personGeneration"],f);const p=i(n,["includeSafetyAttributes"]);e!==void 0&&p!=null&&r(e,["parameters","includeSafetyAttributes"],p);const m=i(n,["includeRaiReason"]);e!==void 0&&m!=null&&r(e,["parameters","includeRaiReason"],m);const h=i(n,["language"]);e!==void 0&&h!=null&&r(e,["parameters","language"],h);const g=i(n,["outputMimeType"]);e!==void 0&&g!=null&&r(e,["parameters","outputOptions","mimeType"],g);const y=i(n,["outputCompressionQuality"]);e!==void 0&&y!=null&&r(e,["parameters","outputOptions","compressionQuality"],y);const T=i(n,["addWatermark"]);e!==void 0&&T!=null&&r(e,["parameters","addWatermark"],T);const S=i(n,["labels"]);e!==void 0&&S!=null&&r(e,["labels"],S);const v=i(n,["editMode"]);e!==void 0&&v!=null&&r(e,["parameters","editMode"],v);const _=i(n,["baseSteps"]);return e!==void 0&&_!=null&&r(e,["parameters","editConfig","baseSteps"],_),t}function Ls(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["prompt"]);s!=null&&r(t,["instances[0]","prompt"],s);const l=i(e,["referenceImages"]);if(l!=null){let u=l;Array.isArray(u)&&(u=u.map(c=>Dr(c))),r(t,["instances[0]","referenceImages"],u)}const a=i(e,["config"]);return a!=null&&xs(a,t),t}function Us(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["predictions"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>Ee(l))),r(e,["generatedImages"],s)}return e}function qs(n,e){const t={},o=i(n,["taskType"]);e!==void 0&&o!=null&&r(e,["requests[]","taskType"],o);const s=i(n,["title"]);e!==void 0&&s!=null&&r(e,["requests[]","title"],s);const l=i(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&r(e,["requests[]","outputDimensionality"],l),i(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(i(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function Vs(n,e){const t={},o=i(n,["taskType"]);e!==void 0&&o!=null&&r(e,["instances[]","task_type"],o);const s=i(n,["title"]);e!==void 0&&s!=null&&r(e,["instances[]","title"],s);const l=i(n,["outputDimensionality"]);e!==void 0&&l!=null&&r(e,["parameters","outputDimensionality"],l);const a=i(n,["mimeType"]);e!==void 0&&a!=null&&r(e,["instances[]","mimeType"],a);const u=i(n,["autoTruncate"]);return e!==void 0&&u!=null&&r(e,["parameters","autoTruncate"],u),t}function Fs(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["contents"]);if(s!=null){let u=qe(n,s);Array.isArray(u)&&(u=u.map(c=>c)),r(t,["requests[]","content"],u)}const l=i(e,["config"]);l!=null&&qs(l,t);const a=i(e,["model"]);return a!==void 0&&r(t,["requests[]","model"],N(n,a)),t}function Gs(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["contents"]);if(s!=null){let a=qe(n,s);Array.isArray(a)&&(a=a.map(u=>u)),r(t,["instances[]","content"],a)}const l=i(e,["config"]);return l!=null&&Vs(l,t),t}function bs(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["embeddings"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(a=>a)),r(e,["embeddings"],l)}const s=i(n,["metadata"]);return s!=null&&r(e,["metadata"],s),e}function Hs(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["predictions[]","embeddings"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(a=>Es(a))),r(e,["embeddings"],l)}const s=i(n,["metadata"]);return s!=null&&r(e,["metadata"],s),e}function Bs(n){const e={},t=i(n,["endpoint"]);t!=null&&r(e,["name"],t);const o=i(n,["deployedModelId"]);return o!=null&&r(e,["deployedModelId"],o),e}function Js(n){const e={};if(i(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=i(n,["fileUri"]);t!=null&&r(e,["fileUri"],t);const o=i(n,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function $s(n){const e={};if(i(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=i(n,["description"]);t!=null&&r(e,["description"],t);const o=i(n,["name"]);o!=null&&r(e,["name"],o);const s=i(n,["parameters"]);s!=null&&r(e,["parameters"],s);const l=i(n,["parametersJsonSchema"]);l!=null&&r(e,["parametersJsonSchema"],l);const a=i(n,["response"]);a!=null&&r(e,["response"],a);const u=i(n,["responseJsonSchema"]);return u!=null&&r(e,["responseJsonSchema"],u),e}function Ys(n,e,t){const o={},s=i(e,["systemInstruction"]);t!==void 0&&s!=null&&r(t,["systemInstruction"],Ce(q(s)));const l=i(e,["temperature"]);l!=null&&r(o,["temperature"],l);const a=i(e,["topP"]);a!=null&&r(o,["topP"],a);const u=i(e,["topK"]);u!=null&&r(o,["topK"],u);const c=i(e,["candidateCount"]);c!=null&&r(o,["candidateCount"],c);const d=i(e,["maxOutputTokens"]);d!=null&&r(o,["maxOutputTokens"],d);const f=i(e,["stopSequences"]);f!=null&&r(o,["stopSequences"],f);const p=i(e,["responseLogprobs"]);p!=null&&r(o,["responseLogprobs"],p);const m=i(e,["logprobs"]);m!=null&&r(o,["logprobs"],m);const h=i(e,["presencePenalty"]);h!=null&&r(o,["presencePenalty"],h);const g=i(e,["frequencyPenalty"]);g!=null&&r(o,["frequencyPenalty"],g);const y=i(e,["seed"]);y!=null&&r(o,["seed"],y);const T=i(e,["responseMimeType"]);T!=null&&r(o,["responseMimeType"],T);const S=i(e,["responseSchema"]);S!=null&&r(o,["responseSchema"],Ve(S));const v=i(e,["responseJsonSchema"]);if(v!=null&&r(o,["responseJsonSchema"],v),i(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(i(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=i(e,["safetySettings"]);if(t!==void 0&&_!=null){let x=_;Array.isArray(x)&&(x=x.map(b=>kr(b))),r(t,["safetySettings"],x)}const I=i(e,["tools"]);if(t!==void 0&&I!=null){let x=oe(I);Array.isArray(x)&&(x=x.map(b=>Fr(te(b)))),r(t,["tools"],x)}const R=i(e,["toolConfig"]);if(t!==void 0&&R!=null&&r(t,["toolConfig"],R),i(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=i(e,["cachedContent"]);t!==void 0&&M!=null&&r(t,["cachedContent"],$(n,M));const P=i(e,["responseModalities"]);P!=null&&r(o,["responseModalities"],P);const U=i(e,["mediaResolution"]);U!=null&&r(o,["mediaResolution"],U);const A=i(e,["speechConfig"]);if(A!=null&&r(o,["speechConfig"],Fe(A)),i(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const w=i(e,["thinkingConfig"]);w!=null&&r(o,["thinkingConfig"],w);const V=i(e,["imageConfig"]);return V!=null&&r(o,["imageConfig"],V),o}function Ks(n,e,t){const o={},s=i(e,["systemInstruction"]);t!==void 0&&s!=null&&r(t,["systemInstruction"],q(s));const l=i(e,["temperature"]);l!=null&&r(o,["temperature"],l);const a=i(e,["topP"]);a!=null&&r(o,["topP"],a);const u=i(e,["topK"]);u!=null&&r(o,["topK"],u);const c=i(e,["candidateCount"]);c!=null&&r(o,["candidateCount"],c);const d=i(e,["maxOutputTokens"]);d!=null&&r(o,["maxOutputTokens"],d);const f=i(e,["stopSequences"]);f!=null&&r(o,["stopSequences"],f);const p=i(e,["responseLogprobs"]);p!=null&&r(o,["responseLogprobs"],p);const m=i(e,["logprobs"]);m!=null&&r(o,["logprobs"],m);const h=i(e,["presencePenalty"]);h!=null&&r(o,["presencePenalty"],h);const g=i(e,["frequencyPenalty"]);g!=null&&r(o,["frequencyPenalty"],g);const y=i(e,["seed"]);y!=null&&r(o,["seed"],y);const T=i(e,["responseMimeType"]);T!=null&&r(o,["responseMimeType"],T);const S=i(e,["responseSchema"]);S!=null&&r(o,["responseSchema"],Ve(S));const v=i(e,["responseJsonSchema"]);v!=null&&r(o,["responseJsonSchema"],v);const _=i(e,["routingConfig"]);_!=null&&r(o,["routingConfig"],_);const I=i(e,["modelSelectionConfig"]);I!=null&&r(o,["modelConfig"],I);const R=i(e,["safetySettings"]);if(t!==void 0&&R!=null){let B=R;Array.isArray(B)&&(B=B.map(Ie=>Ie)),r(t,["safetySettings"],B)}const M=i(e,["tools"]);if(t!==void 0&&M!=null){let B=oe(M);Array.isArray(B)&&(B=B.map(Ie=>Mt(te(Ie)))),r(t,["tools"],B)}const P=i(e,["toolConfig"]);t!==void 0&&P!=null&&r(t,["toolConfig"],P);const U=i(e,["labels"]);t!==void 0&&U!=null&&r(t,["labels"],U);const A=i(e,["cachedContent"]);t!==void 0&&A!=null&&r(t,["cachedContent"],$(n,A));const w=i(e,["responseModalities"]);w!=null&&r(o,["responseModalities"],w);const V=i(e,["mediaResolution"]);V!=null&&r(o,["mediaResolution"],V);const x=i(e,["speechConfig"]);x!=null&&r(o,["speechConfig"],Rt(Fe(x)));const b=i(e,["audioTimestamp"]);b!=null&&r(o,["audioTimestamp"],b);const He=i(e,["thinkingConfig"]);He!=null&&r(o,["thinkingConfig"],He);const Be=i(e,["imageConfig"]);return Be!=null&&r(o,["imageConfig"],Be),o}function Zn(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["contents"]);if(s!=null){let a=F(s);Array.isArray(a)&&(a=a.map(u=>Ce(u))),r(t,["contents"],a)}const l=i(e,["config"]);return l!=null&&r(t,["generationConfig"],Ys(n,l,t)),t}function On(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["contents"]);if(s!=null){let a=F(s);Array.isArray(a)&&(a=a.map(u=>u)),r(t,["contents"],a)}const l=i(e,["config"]);return l!=null&&r(t,["generationConfig"],Ks(n,l,t)),t}function jn(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["candidates"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>gs(d))),r(e,["candidates"],c)}const s=i(n,["modelVersion"]);s!=null&&r(e,["modelVersion"],s);const l=i(n,["promptFeedback"]);l!=null&&r(e,["promptFeedback"],l);const a=i(n,["responseId"]);a!=null&&r(e,["responseId"],a);const u=i(n,["usageMetadata"]);return u!=null&&r(e,["usageMetadata"],u),e}function et(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["candidates"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>f)),r(e,["candidates"],d)}const s=i(n,["createTime"]);s!=null&&r(e,["createTime"],s);const l=i(n,["modelVersion"]);l!=null&&r(e,["modelVersion"],l);const a=i(n,["promptFeedback"]);a!=null&&r(e,["promptFeedback"],a);const u=i(n,["responseId"]);u!=null&&r(e,["responseId"],u);const c=i(n,["usageMetadata"]);return c!=null&&r(e,["usageMetadata"],c),e}function Ws(n,e){const t={};if(i(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(i(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const o=i(n,["numberOfImages"]);e!==void 0&&o!=null&&r(e,["parameters","sampleCount"],o);const s=i(n,["aspectRatio"]);e!==void 0&&s!=null&&r(e,["parameters","aspectRatio"],s);const l=i(n,["guidanceScale"]);if(e!==void 0&&l!=null&&r(e,["parameters","guidanceScale"],l),i(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=i(n,["safetyFilterLevel"]);e!==void 0&&a!=null&&r(e,["parameters","safetySetting"],a);const u=i(n,["personGeneration"]);e!==void 0&&u!=null&&r(e,["parameters","personGeneration"],u);const c=i(n,["includeSafetyAttributes"]);e!==void 0&&c!=null&&r(e,["parameters","includeSafetyAttributes"],c);const d=i(n,["includeRaiReason"]);e!==void 0&&d!=null&&r(e,["parameters","includeRaiReason"],d);const f=i(n,["language"]);e!==void 0&&f!=null&&r(e,["parameters","language"],f);const p=i(n,["outputMimeType"]);e!==void 0&&p!=null&&r(e,["parameters","outputOptions","mimeType"],p);const m=i(n,["outputCompressionQuality"]);if(e!==void 0&&m!=null&&r(e,["parameters","outputOptions","compressionQuality"],m),i(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(i(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const h=i(n,["imageSize"]);if(e!==void 0&&h!=null&&r(e,["parameters","sampleImageSize"],h),i(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function zs(n,e){const t={},o=i(n,["outputGcsUri"]);e!==void 0&&o!=null&&r(e,["parameters","storageUri"],o);const s=i(n,["negativePrompt"]);e!==void 0&&s!=null&&r(e,["parameters","negativePrompt"],s);const l=i(n,["numberOfImages"]);e!==void 0&&l!=null&&r(e,["parameters","sampleCount"],l);const a=i(n,["aspectRatio"]);e!==void 0&&a!=null&&r(e,["parameters","aspectRatio"],a);const u=i(n,["guidanceScale"]);e!==void 0&&u!=null&&r(e,["parameters","guidanceScale"],u);const c=i(n,["seed"]);e!==void 0&&c!=null&&r(e,["parameters","seed"],c);const d=i(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&r(e,["parameters","safetySetting"],d);const f=i(n,["personGeneration"]);e!==void 0&&f!=null&&r(e,["parameters","personGeneration"],f);const p=i(n,["includeSafetyAttributes"]);e!==void 0&&p!=null&&r(e,["parameters","includeSafetyAttributes"],p);const m=i(n,["includeRaiReason"]);e!==void 0&&m!=null&&r(e,["parameters","includeRaiReason"],m);const h=i(n,["language"]);e!==void 0&&h!=null&&r(e,["parameters","language"],h);const g=i(n,["outputMimeType"]);e!==void 0&&g!=null&&r(e,["parameters","outputOptions","mimeType"],g);const y=i(n,["outputCompressionQuality"]);e!==void 0&&y!=null&&r(e,["parameters","outputOptions","compressionQuality"],y);const T=i(n,["addWatermark"]);e!==void 0&&T!=null&&r(e,["parameters","addWatermark"],T);const S=i(n,["labels"]);e!==void 0&&S!=null&&r(e,["labels"],S);const v=i(n,["imageSize"]);e!==void 0&&v!=null&&r(e,["parameters","sampleImageSize"],v);const _=i(n,["enhancePrompt"]);return e!==void 0&&_!=null&&r(e,["parameters","enhancePrompt"],_),t}function Xs(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["prompt"]);s!=null&&r(t,["instances[0]","prompt"],s);const l=i(e,["config"]);return l!=null&&Ws(l,t),t}function Qs(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["prompt"]);s!=null&&r(t,["instances[0]","prompt"],s);const l=i(e,["config"]);return l!=null&&zs(l,t),t}function Zs(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["predictions"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(a=>ur(a))),r(e,["generatedImages"],l)}const s=i(n,["positivePromptSafetyAttributes"]);return s!=null&&r(e,["positivePromptSafetyAttributes"],It(s)),e}function Os(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["predictions"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(a=>Ee(a))),r(e,["generatedImages"],l)}const s=i(n,["positivePromptSafetyAttributes"]);return s!=null&&r(e,["positivePromptSafetyAttributes"],At(s)),e}function js(n,e){const t={},o=i(n,["numberOfVideos"]);if(e!==void 0&&o!=null&&r(e,["parameters","sampleCount"],o),i(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(i(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=i(n,["durationSeconds"]);if(e!==void 0&&s!=null&&r(e,["parameters","durationSeconds"],s),i(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=i(n,["aspectRatio"]);e!==void 0&&l!=null&&r(e,["parameters","aspectRatio"],l);const a=i(n,["resolution"]);e!==void 0&&a!=null&&r(e,["parameters","resolution"],a);const u=i(n,["personGeneration"]);if(e!==void 0&&u!=null&&r(e,["parameters","personGeneration"],u),i(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=i(n,["negativePrompt"]);e!==void 0&&c!=null&&r(e,["parameters","negativePrompt"],c);const d=i(n,["enhancePrompt"]);if(e!==void 0&&d!=null&&r(e,["parameters","enhancePrompt"],d),i(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=i(n,["lastFrame"]);e!==void 0&&f!=null&&r(e,["instances[0]","lastFrame"],_e(f));const p=i(n,["referenceImages"]);if(e!==void 0&&p!=null){let m=p;Array.isArray(m)&&(m=m.map(h=>Zr(h))),r(e,["instances[0]","referenceImages"],m)}if(i(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(i(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function er(n,e){const t={},o=i(n,["numberOfVideos"]);e!==void 0&&o!=null&&r(e,["parameters","sampleCount"],o);const s=i(n,["outputGcsUri"]);e!==void 0&&s!=null&&r(e,["parameters","storageUri"],s);const l=i(n,["fps"]);e!==void 0&&l!=null&&r(e,["parameters","fps"],l);const a=i(n,["durationSeconds"]);e!==void 0&&a!=null&&r(e,["parameters","durationSeconds"],a);const u=i(n,["seed"]);e!==void 0&&u!=null&&r(e,["parameters","seed"],u);const c=i(n,["aspectRatio"]);e!==void 0&&c!=null&&r(e,["parameters","aspectRatio"],c);const d=i(n,["resolution"]);e!==void 0&&d!=null&&r(e,["parameters","resolution"],d);const f=i(n,["personGeneration"]);e!==void 0&&f!=null&&r(e,["parameters","personGeneration"],f);const p=i(n,["pubsubTopic"]);e!==void 0&&p!=null&&r(e,["parameters","pubsubTopic"],p);const m=i(n,["negativePrompt"]);e!==void 0&&m!=null&&r(e,["parameters","negativePrompt"],m);const h=i(n,["enhancePrompt"]);e!==void 0&&h!=null&&r(e,["parameters","enhancePrompt"],h);const g=i(n,["generateAudio"]);e!==void 0&&g!=null&&r(e,["parameters","generateAudio"],g);const y=i(n,["lastFrame"]);e!==void 0&&y!=null&&r(e,["instances[0]","lastFrame"],G(y));const T=i(n,["referenceImages"]);if(e!==void 0&&T!=null){let _=T;Array.isArray(_)&&(_=_.map(I=>Or(I))),r(e,["instances[0]","referenceImages"],_)}const S=i(n,["mask"]);e!==void 0&&S!=null&&r(e,["instances[0]","mask"],Qr(S));const v=i(n,["compressionQuality"]);return e!==void 0&&v!=null&&r(e,["parameters","compressionQuality"],v),t}function nr(n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const o=i(n,["metadata"]);o!=null&&r(e,["metadata"],o);const s=i(n,["done"]);s!=null&&r(e,["done"],s);const l=i(n,["error"]);l!=null&&r(e,["error"],l);const a=i(n,["response","generateVideoResponse"]);return a!=null&&r(e,["response"],sr(a)),e}function tr(n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const o=i(n,["metadata"]);o!=null&&r(e,["metadata"],o);const s=i(n,["done"]);s!=null&&r(e,["done"],s);const l=i(n,["error"]);l!=null&&r(e,["error"],l);const a=i(n,["response"]);return a!=null&&r(e,["response"],rr(a)),e}function or(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["prompt"]);s!=null&&r(t,["instances[0]","prompt"],s);const l=i(e,["image"]);l!=null&&r(t,["instances[0]","image"],_e(l));const a=i(e,["video"]);a!=null&&r(t,["instances[0]","video"],Pt(a));const u=i(e,["source"]);u!=null&&lr(u,t);const c=i(e,["config"]);return c!=null&&js(c,t),t}function ir(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["prompt"]);s!=null&&r(t,["instances[0]","prompt"],s);const l=i(e,["image"]);l!=null&&r(t,["instances[0]","image"],G(l));const a=i(e,["video"]);a!=null&&r(t,["instances[0]","video"],Nt(a));const u=i(e,["source"]);u!=null&&ar(u,t);const c=i(e,["config"]);return c!=null&&er(c,t),t}function sr(n){const e={},t=i(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>cr(a))),r(e,["generatedVideos"],l)}const o=i(n,["raiMediaFilteredCount"]);o!=null&&r(e,["raiMediaFilteredCount"],o);const s=i(n,["raiMediaFilteredReasons"]);return s!=null&&r(e,["raiMediaFilteredReasons"],s),e}function rr(n){const e={},t=i(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>fr(a))),r(e,["generatedVideos"],l)}const o=i(n,["raiMediaFilteredCount"]);o!=null&&r(e,["raiMediaFilteredCount"],o);const s=i(n,["raiMediaFilteredReasons"]);return s!=null&&r(e,["raiMediaFilteredReasons"],s),e}function lr(n,e){const t={},o=i(n,["prompt"]);e!==void 0&&o!=null&&r(e,["instances[0]","prompt"],o);const s=i(n,["image"]);e!==void 0&&s!=null&&r(e,["instances[0]","image"],_e(s));const l=i(n,["video"]);return e!==void 0&&l!=null&&r(e,["instances[0]","video"],Pt(l)),t}function ar(n,e){const t={},o=i(n,["prompt"]);e!==void 0&&o!=null&&r(e,["instances[0]","prompt"],o);const s=i(n,["image"]);e!==void 0&&s!=null&&r(e,["instances[0]","image"],G(s));const l=i(n,["video"]);return e!==void 0&&l!=null&&r(e,["instances[0]","video"],Nt(l)),t}function ur(n){const e={},t=i(n,["_self"]);t!=null&&r(e,["image"],yr(t));const o=i(n,["raiFilteredReason"]);o!=null&&r(e,["raiFilteredReason"],o);const s=i(n,["_self"]);return s!=null&&r(e,["safetyAttributes"],It(s)),e}function Ee(n){const e={},t=i(n,["_self"]);t!=null&&r(e,["image"],St(t));const o=i(n,["raiFilteredReason"]);o!=null&&r(e,["raiFilteredReason"],o);const s=i(n,["_self"]);s!=null&&r(e,["safetyAttributes"],At(s));const l=i(n,["prompt"]);return l!=null&&r(e,["enhancedPrompt"],l),e}function dr(n){const e={},t=i(n,["_self"]);t!=null&&r(e,["mask"],St(t));const o=i(n,["labels"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>l)),r(e,["labels"],s)}return e}function cr(n){const e={},t=i(n,["_self"]);return t!=null&&r(e,["video"],zr(t)),e}function fr(n){const e={},t=i(n,["_self"]);return t!=null&&r(e,["video"],Xr(t)),e}function pr(n){const e={},t=i(n,["modelSelectionConfig"]);t!=null&&r(e,["modelConfig"],t);const o=i(n,["audioTimestamp"]);o!=null&&r(e,["audioTimestamp"],o);const s=i(n,["candidateCount"]);s!=null&&r(e,["candidateCount"],s);const l=i(n,["enableAffectiveDialog"]);l!=null&&r(e,["enableAffectiveDialog"],l);const a=i(n,["frequencyPenalty"]);a!=null&&r(e,["frequencyPenalty"],a);const u=i(n,["logprobs"]);u!=null&&r(e,["logprobs"],u);const c=i(n,["maxOutputTokens"]);c!=null&&r(e,["maxOutputTokens"],c);const d=i(n,["mediaResolution"]);d!=null&&r(e,["mediaResolution"],d);const f=i(n,["presencePenalty"]);f!=null&&r(e,["presencePenalty"],f);const p=i(n,["responseJsonSchema"]);p!=null&&r(e,["responseJsonSchema"],p);const m=i(n,["responseLogprobs"]);m!=null&&r(e,["responseLogprobs"],m);const h=i(n,["responseMimeType"]);h!=null&&r(e,["responseMimeType"],h);const g=i(n,["responseModalities"]);g!=null&&r(e,["responseModalities"],g);const y=i(n,["responseSchema"]);y!=null&&r(e,["responseSchema"],y);const T=i(n,["routingConfig"]);T!=null&&r(e,["routingConfig"],T);const S=i(n,["seed"]);S!=null&&r(e,["seed"],S);const v=i(n,["speechConfig"]);v!=null&&r(e,["speechConfig"],Rt(v));const _=i(n,["stopSequences"]);_!=null&&r(e,["stopSequences"],_);const I=i(n,["temperature"]);I!=null&&r(e,["temperature"],I);const R=i(n,["thinkingConfig"]);R!=null&&r(e,["thinkingConfig"],R);const M=i(n,["topK"]);M!=null&&r(e,["topK"],M);const P=i(n,["topP"]);return P!=null&&r(e,["topP"],P),e}function mr(n,e){const t={},o=i(e,["model"]);return o!=null&&r(t,["_url","name"],N(n,o)),t}function hr(n,e){const t={},o=i(e,["model"]);return o!=null&&r(t,["_url","name"],N(n,o)),t}function gr(n){const e={},t=i(n,["timeRangeFilter"]);if(t!=null&&r(e,["timeRangeFilter"],t),i(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function yr(n){const e={},t=i(n,["bytesBase64Encoded"]);t!=null&&r(e,["imageBytes"],K(t));const o=i(n,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function St(n){const e={},t=i(n,["gcsUri"]);t!=null&&r(e,["gcsUri"],t);const o=i(n,["bytesBase64Encoded"]);o!=null&&r(e,["imageBytes"],K(o));const s=i(n,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function _e(n){const e={};if(i(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=i(n,["imageBytes"]);t!=null&&r(e,["bytesBase64Encoded"],K(t));const o=i(n,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function G(n){const e={},t=i(n,["gcsUri"]);t!=null&&r(e,["gcsUri"],t);const o=i(n,["imageBytes"]);o!=null&&r(e,["bytesBase64Encoded"],K(o));const s=i(n,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function Tr(n,e,t){const o={},s=i(e,["pageSize"]);t!==void 0&&s!=null&&r(t,["_query","pageSize"],s);const l=i(e,["pageToken"]);t!==void 0&&l!=null&&r(t,["_query","pageToken"],l);const a=i(e,["filter"]);t!==void 0&&a!=null&&r(t,["_query","filter"],a);const u=i(e,["queryBase"]);return t!==void 0&&u!=null&&r(t,["_url","models_url"],ht(n,u)),o}function Cr(n,e,t){const o={},s=i(e,["pageSize"]);t!==void 0&&s!=null&&r(t,["_query","pageSize"],s);const l=i(e,["pageToken"]);t!==void 0&&l!=null&&r(t,["_query","pageToken"],l);const a=i(e,["filter"]);t!==void 0&&a!=null&&r(t,["_query","filter"],a);const u=i(e,["queryBase"]);return t!==void 0&&u!=null&&r(t,["_url","models_url"],ht(n,u)),o}function Er(n,e){const t={},o=i(e,["config"]);return o!=null&&Tr(n,o,t),t}function _r(n,e){const t={},o=i(e,["config"]);return o!=null&&Cr(n,o,t),t}function vr(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(n,["_self"]);if(s!=null){let l=gt(s);Array.isArray(l)&&(l=l.map(a=>De(a))),r(e,["models"],l)}return e}function Sr(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(n,["_self"]);if(s!=null){let l=gt(s);Array.isArray(l)&&(l=l.map(a=>ke(a))),r(e,["models"],l)}return e}function Ir(n){const e={},t=i(n,["maskMode"]);t!=null&&r(e,["maskMode"],t);const o=i(n,["segmentationClasses"]);o!=null&&r(e,["maskClasses"],o);const s=i(n,["maskDilation"]);return s!=null&&r(e,["dilation"],s),e}function De(n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const o=i(n,["displayName"]);o!=null&&r(e,["displayName"],o);const s=i(n,["description"]);s!=null&&r(e,["description"],s);const l=i(n,["version"]);l!=null&&r(e,["version"],l);const a=i(n,["_self"]);a!=null&&r(e,["tunedModelInfo"],Gr(a));const u=i(n,["inputTokenLimit"]);u!=null&&r(e,["inputTokenLimit"],u);const c=i(n,["outputTokenLimit"]);c!=null&&r(e,["outputTokenLimit"],c);const d=i(n,["supportedGenerationMethods"]);return d!=null&&r(e,["supportedActions"],d),e}function ke(n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const o=i(n,["displayName"]);o!=null&&r(e,["displayName"],o);const s=i(n,["description"]);s!=null&&r(e,["description"],s);const l=i(n,["versionId"]);l!=null&&r(e,["version"],l);const a=i(n,["deployedModels"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(m=>Bs(m))),r(e,["endpoints"],p)}const u=i(n,["labels"]);u!=null&&r(e,["labels"],u);const c=i(n,["_self"]);c!=null&&r(e,["tunedModelInfo"],br(c));const d=i(n,["defaultCheckpointId"]);d!=null&&r(e,["defaultCheckpointId"],d);const f=i(n,["checkpoints"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(m=>m)),r(e,["checkpoints"],p)}return e}function Ar(n){const e={},t=i(n,["videoMetadata"]);t!=null&&r(e,["videoMetadata"],t);const o=i(n,["thought"]);o!=null&&r(e,["thought"],o);const s=i(n,["inlineData"]);s!=null&&r(e,["inlineData"],hs(s));const l=i(n,["fileData"]);l!=null&&r(e,["fileData"],Js(l));const a=i(n,["thoughtSignature"]);a!=null&&r(e,["thoughtSignature"],a);const u=i(n,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=i(n,["codeExecutionResult"]);c!=null&&r(e,["codeExecutionResult"],c);const d=i(n,["executableCode"]);d!=null&&r(e,["executableCode"],d);const f=i(n,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=i(n,["text"]);return p!=null&&r(e,["text"],p),e}function Rr(n){const e={},t=i(n,["productImage"]);return t!=null&&r(e,["image"],G(t)),e}function Mr(n,e){const t={},o=i(n,["numberOfImages"]);e!==void 0&&o!=null&&r(e,["parameters","sampleCount"],o);const s=i(n,["baseSteps"]);e!==void 0&&s!=null&&r(e,["parameters","editConfig","baseSteps"],s);const l=i(n,["outputGcsUri"]);e!==void 0&&l!=null&&r(e,["parameters","storageUri"],l);const a=i(n,["seed"]);e!==void 0&&a!=null&&r(e,["parameters","seed"],a);const u=i(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&r(e,["parameters","safetySetting"],u);const c=i(n,["personGeneration"]);e!==void 0&&c!=null&&r(e,["parameters","personGeneration"],c);const d=i(n,["addWatermark"]);e!==void 0&&d!=null&&r(e,["parameters","addWatermark"],d);const f=i(n,["outputMimeType"]);e!==void 0&&f!=null&&r(e,["parameters","outputOptions","mimeType"],f);const p=i(n,["outputCompressionQuality"]);e!==void 0&&p!=null&&r(e,["parameters","outputOptions","compressionQuality"],p);const m=i(n,["enhancePrompt"]);e!==void 0&&m!=null&&r(e,["parameters","enhancePrompt"],m);const h=i(n,["labels"]);return e!==void 0&&h!=null&&r(e,["labels"],h),t}function Pr(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["source"]);s!=null&&wr(s,t);const l=i(e,["config"]);return l!=null&&Mr(l,t),t}function Nr(n){const e={},t=i(n,["predictions"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>Ee(s))),r(e,["generatedImages"],o)}return e}function wr(n,e){const t={},o=i(n,["prompt"]);e!==void 0&&o!=null&&r(e,["instances[0]","prompt"],o);const s=i(n,["personImage"]);e!==void 0&&s!=null&&r(e,["instances[0]","personImage","image"],G(s));const l=i(n,["productImages"]);if(e!==void 0&&l!=null){let a=l;Array.isArray(a)&&(a=a.map(u=>Rr(u))),r(e,["instances[0]","productImages"],a)}return t}function Dr(n){const e={},t=i(n,["referenceImage"]);t!=null&&r(e,["referenceImage"],G(t));const o=i(n,["referenceId"]);o!=null&&r(e,["referenceId"],o);const s=i(n,["referenceType"]);s!=null&&r(e,["referenceType"],s);const l=i(n,["maskImageConfig"]);l!=null&&r(e,["maskImageConfig"],Ir(l));const a=i(n,["controlImageConfig"]);a!=null&&r(e,["controlImageConfig"],vs(a));const u=i(n,["styleImageConfig"]);u!=null&&r(e,["styleImageConfig"],u);const c=i(n,["subjectImageConfig"]);return c!=null&&r(e,["subjectImageConfig"],c),e}function It(n){const e={},t=i(n,["safetyAttributes","categories"]);t!=null&&r(e,["categories"],t);const o=i(n,["safetyAttributes","scores"]);o!=null&&r(e,["scores"],o);const s=i(n,["contentType"]);return s!=null&&r(e,["contentType"],s),e}function At(n){const e={},t=i(n,["safetyAttributes","categories"]);t!=null&&r(e,["categories"],t);const o=i(n,["safetyAttributes","scores"]);o!=null&&r(e,["scores"],o);const s=i(n,["contentType"]);return s!=null&&r(e,["contentType"],s),e}function kr(n){const e={};if(i(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=i(n,["category"]);t!=null&&r(e,["category"],t);const o=i(n,["threshold"]);return o!=null&&r(e,["threshold"],o),e}function xr(n){const e={},t=i(n,["image"]);return t!=null&&r(e,["image"],G(t)),e}function Lr(n,e){const t={},o=i(n,["mode"]);e!==void 0&&o!=null&&r(e,["parameters","mode"],o);const s=i(n,["maxPredictions"]);e!==void 0&&s!=null&&r(e,["parameters","maxPredictions"],s);const l=i(n,["confidenceThreshold"]);e!==void 0&&l!=null&&r(e,["parameters","confidenceThreshold"],l);const a=i(n,["maskDilation"]);e!==void 0&&a!=null&&r(e,["parameters","maskDilation"],a);const u=i(n,["binaryColorThreshold"]);e!==void 0&&u!=null&&r(e,["parameters","binaryColorThreshold"],u);const c=i(n,["labels"]);return e!==void 0&&c!=null&&r(e,["labels"],c),t}function Ur(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["source"]);s!=null&&Vr(s,t);const l=i(e,["config"]);return l!=null&&Lr(l,t),t}function qr(n){const e={},t=i(n,["predictions"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>dr(s))),r(e,["generatedMasks"],o)}return e}function Vr(n,e){const t={},o=i(n,["prompt"]);e!==void 0&&o!=null&&r(e,["instances[0]","prompt"],o);const s=i(n,["image"]);e!==void 0&&s!=null&&r(e,["instances[0]","image"],G(s));const l=i(n,["scribbleImage"]);return e!==void 0&&l!=null&&r(e,["instances[0]","scribble"],xr(l)),t}function Rt(n){const e={},t=i(n,["voiceConfig"]);if(t!=null&&r(e,["voiceConfig"],t),i(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const o=i(n,["languageCode"]);return o!=null&&r(e,["languageCode"],o),e}function Fr(n){const e={},t=i(n,["functionDeclarations"]);if(t!=null){let c=t;Array.isArray(c)&&(c=c.map(d=>d)),r(e,["functionDeclarations"],c)}if(i(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=i(n,["googleSearch"]);o!=null&&r(e,["googleSearch"],gr(o));const s=i(n,["googleSearchRetrieval"]);if(s!=null&&r(e,["googleSearchRetrieval"],s),i(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(i(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=i(n,["urlContext"]);l!=null&&r(e,["urlContext"],l);const a=i(n,["computerUse"]);a!=null&&r(e,["computerUse"],a);const u=i(n,["codeExecution"]);return u!=null&&r(e,["codeExecution"],u),e}function Mt(n){const e={},t=i(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(m=>$s(m))),r(e,["functionDeclarations"],p)}const o=i(n,["retrieval"]);o!=null&&r(e,["retrieval"],o);const s=i(n,["googleSearch"]);s!=null&&r(e,["googleSearch"],s);const l=i(n,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],l);const a=i(n,["enterpriseWebSearch"]);a!=null&&r(e,["enterpriseWebSearch"],a);const u=i(n,["googleMaps"]);u!=null&&r(e,["googleMaps"],u);const c=i(n,["urlContext"]);c!=null&&r(e,["urlContext"],c);const d=i(n,["computerUse"]);d!=null&&r(e,["computerUse"],d);const f=i(n,["codeExecution"]);return f!=null&&r(e,["codeExecution"],f),e}function Gr(n){const e={},t=i(n,["baseModel"]);t!=null&&r(e,["baseModel"],t);const o=i(n,["createTime"]);o!=null&&r(e,["createTime"],o);const s=i(n,["updateTime"]);return s!=null&&r(e,["updateTime"],s),e}function br(n){const e={},t=i(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&r(e,["baseModel"],t);const o=i(n,["createTime"]);o!=null&&r(e,["createTime"],o);const s=i(n,["updateTime"]);return s!=null&&r(e,["updateTime"],s),e}function Hr(n,e){const t={},o=i(n,["displayName"]);e!==void 0&&o!=null&&r(e,["displayName"],o);const s=i(n,["description"]);e!==void 0&&s!=null&&r(e,["description"],s);const l=i(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&r(e,["defaultCheckpointId"],l),t}function Br(n,e){const t={},o=i(n,["displayName"]);e!==void 0&&o!=null&&r(e,["displayName"],o);const s=i(n,["description"]);e!==void 0&&s!=null&&r(e,["description"],s);const l=i(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&r(e,["defaultCheckpointId"],l),t}function Jr(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","name"],N(n,o));const s=i(e,["config"]);return s!=null&&Hr(s,t),t}function $r(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["config"]);return s!=null&&Br(s,t),t}function Yr(n,e){const t={},o=i(n,["outputGcsUri"]);e!==void 0&&o!=null&&r(e,["parameters","storageUri"],o);const s=i(n,["includeRaiReason"]);e!==void 0&&s!=null&&r(e,["parameters","includeRaiReason"],s);const l=i(n,["outputMimeType"]);e!==void 0&&l!=null&&r(e,["parameters","outputOptions","mimeType"],l);const a=i(n,["outputCompressionQuality"]);e!==void 0&&a!=null&&r(e,["parameters","outputOptions","compressionQuality"],a);const u=i(n,["enhanceInputImage"]);e!==void 0&&u!=null&&r(e,["parameters","upscaleConfig","enhanceInputImage"],u);const c=i(n,["imagePreservationFactor"]);e!==void 0&&c!=null&&r(e,["parameters","upscaleConfig","imagePreservationFactor"],c);const d=i(n,["labels"]);e!==void 0&&d!=null&&r(e,["labels"],d);const f=i(n,["numberOfImages"]);e!==void 0&&f!=null&&r(e,["parameters","sampleCount"],f);const p=i(n,["mode"]);return e!==void 0&&p!=null&&r(e,["parameters","mode"],p),t}function Kr(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["_url","model"],N(n,o));const s=i(e,["image"]);s!=null&&r(t,["instances[0]","image"],G(s));const l=i(e,["upscaleFactor"]);l!=null&&r(t,["parameters","upscaleConfig","upscaleFactor"],l);const a=i(e,["config"]);return a!=null&&Yr(a,t),t}function Wr(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["predictions"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>Ee(l))),r(e,["generatedImages"],s)}return e}function zr(n){const e={},t=i(n,["video","uri"]);t!=null&&r(e,["uri"],t);const o=i(n,["video","encodedVideo"]);o!=null&&r(e,["videoBytes"],K(o));const s=i(n,["encoding"]);return s!=null&&r(e,["mimeType"],s),e}function Xr(n){const e={},t=i(n,["gcsUri"]);t!=null&&r(e,["uri"],t);const o=i(n,["bytesBase64Encoded"]);o!=null&&r(e,["videoBytes"],K(o));const s=i(n,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function Qr(n){const e={},t=i(n,["image"]);t!=null&&r(e,["_self"],G(t));const o=i(n,["maskMode"]);return o!=null&&r(e,["maskMode"],o),e}function Zr(n){const e={},t=i(n,["image"]);t!=null&&r(e,["image"],_e(t));const o=i(n,["referenceType"]);return o!=null&&r(e,["referenceType"],o),e}function Or(n){const e={},t=i(n,["image"]);t!=null&&r(e,["image"],G(t));const o=i(n,["referenceType"]);return o!=null&&r(e,["referenceType"],o),e}function Pt(n){const e={},t=i(n,["uri"]);t!=null&&r(e,["video","uri"],t);const o=i(n,["videoBytes"]);o!=null&&r(e,["video","encodedVideo"],K(o));const s=i(n,["mimeType"]);return s!=null&&r(e,["encoding"],s),e}function Nt(n){const e={},t=i(n,["uri"]);t!=null&&r(e,["gcsUri"],t);const o=i(n,["videoBytes"]);o!=null&&r(e,["bytesBase64Encoded"],K(o));const s=i(n,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jr="Content-Type",el="X-Server-Timeout",nl="User-Agent",xe="x-goog-api-client",tl="1.23.0",ol=`google-genai-sdk/${tl}`,il="v1beta1",sl="v1beta",nt=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class rl{constructor(e){var t,o;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:il,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(o=this.clientOptions.apiVersion)!==null&&o!==void 0?o:sl,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const o=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&o.push(e.apiVersion),o.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,o){const s=[this.getRequestUrlInternal(t)];return o&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,o);if(e.queryParams)for(const[a,u]of Object.entries(e.queryParams))s.searchParams.append(a,String(u));let l={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.unaryApiCall(s,l,e.httpMethod)}patchHttpOptions(e,t){const o=JSON.parse(JSON.stringify(e));for(const[s,l]of Object.entries(t))typeof l=="object"?o[s]=Object.assign(Object.assign({},o[s]),l):l!==void 0&&(o[s]=l);return o}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,o);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.streamApiCall(s,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,o){if(t&&t.timeout||o){const s=new AbortController,l=s.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const a=setTimeout(()=>s.abort(),t.timeout);a&&typeof a.unref=="function"&&a.unref()}o&&o.addEventListener("abort",()=>{s.abort()}),e.signal=l}return t&&t.extraBody!==null&&ll(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:o})).then(async s=>(await tt(s),new Pe(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:o})).then(async s=>(await tt(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var t;return j(this,arguments,function*(){const s=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),l=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let a="";for(;;){const{done:u,value:c}=yield D(s.read());if(u){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=l.decode(c,{stream:!0});try{const p=JSON.parse(d);if("error"in p){const m=JSON.parse(JSON.stringify(p.error)),h=m.status,g=m.code,y=`got status: ${h}. ${JSON.stringify(p)}`;if(g>=400&&g<600)throw new Te({message:y,status:g})}}catch(p){if(p.name==="ApiError")throw p}a+=d;let f=a.match(nt);for(;f;){const p=f[1];try{const m=new Response(p,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield D(new Pe(m)),a=a.slice(f[0].length),f=a.match(nt)}catch(m){throw new Error(`exception parsing stream chunk ${p}. ${m}`)}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(o=>{throw new Error(`exception ${o} sending request`)})}getDefaultHeaders(){const e={},t=ol+" "+this.clientOptions.userAgentExtra;return e[nl]=t,e[xe]=t,e[jr]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[o,s]of Object.entries(e.headers))t.append(o,s);e.timeout&&e.timeout>0&&t.append(el,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var o;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const l=this.clientOptions.uploader,a=await l.stat(e);s.sizeBytes=String(a.size);const u=(o=t==null?void 0:t.mimeType)!==null&&o!==void 0?o:a.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=u;const c=await this.fetchUploadUrl(s,t);return l.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var o;let s={};t!=null&&t.httpOptions?s=t.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const l={file:e},a=await this.request({path:E("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:s});if(!a||!(a!=null&&a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(o=a==null?void 0:a.headers)===null||o===void 0?void 0:o["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function tt(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let o;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?o=await n.json():o={error:{message:await n.text(),code:n.status,status:n.statusText}};const s=JSON.stringify(o);throw t>=400&&t<600?new Te({message:s,status:t}):new Error(s)}}function ll(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const l=JSON.parse(n.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))t=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function o(l,a){const u=Object.assign({},l);for(const c in a)if(Object.prototype.hasOwnProperty.call(a,c)){const d=a[c],f=u[c];d&&typeof d=="object"&&!Array.isArray(d)&&f&&typeof f=="object"&&!Array.isArray(f)?u[c]=o(f,d):(f&&d&&typeof f!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof f}, New type: ${typeof d}. Overwriting.`),u[c]=d)}return u}const s=o(t,e);n.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const al="mcp_used/unknown";let ul=!1;function wt(n){for(const e of n)if(dl(e)||typeof e=="object"&&"inputSchema"in e)return!0;return ul}function Dt(n){var e;const t=(e=n[xe])!==null&&e!==void 0?e:"";n[xe]=(t+` ${al}`).trimStart()}function dl(n){return n!==null&&typeof n=="object"&&n instanceof be}function cl(n,e=100){return j(this,arguments,function*(){let o,s=0;for(;s<e;){const l=yield D(n.listTools({cursor:o}));for(const a of l.tools)yield yield D(a),s++;if(!l.nextCursor)break;o=l.nextCursor}})}class be{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new be(e,t)}async initialize(){var e,t,o,s;if(this.mcpTools.length>0)return;const l={},a=[];for(const f of this.mcpClients)try{for(var u=!0,c=(t=void 0,ue(cl(f))),d;d=await c.next(),e=d.done,!e;u=!0){s=d.value,u=!1;const p=s;a.push(p);const m=p.name;if(l[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);l[m]=f}}catch(p){t={error:p}}finally{try{!u&&!e&&(o=c.return)&&await o.call(c)}finally{if(t)throw t.error}}this.mcpTools=a,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),_o(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const o of e)if(o.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[o.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const a=await s.callTool({name:o.name,arguments:o.args},void 0,l);t.push({functionResponse:{name:o.name,response:a.isError?{error:a}:a}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function fl(n,e,t){const o=new po;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),Object.assign(o,s),e(o)}class pl{constructor(e,t,o){this.apiClient=e,this.auth=t,this.webSocketFactory=o}async connect(e){var t,o;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),a=gl(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),c=`${s}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${u}`;let d=()=>{};const f=new Promise(_=>{d=_}),p=e.callbacks,m=function(){d({})},h=this.apiClient,g={onopen:m,onmessage:_=>{fl(h,p.onmessage,_)},onerror:(t=p==null?void 0:p.onerror)!==null&&t!==void 0?t:function(_){},onclose:(o=p==null?void 0:p.onclose)!==null&&o!==void 0?o:function(_){}},y=this.webSocketFactory.create(c,hl(a),g);y.connect(),await f;const v={setup:{model:N(this.apiClient,e.model)}};return y.send(JSON.stringify(v)),new ml(y,this.apiClient)}}class ml{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=rs(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=ss(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Q.PLAY)}pause(){this.sendPlaybackControl(Q.PAUSE)}stop(){this.sendPlaybackControl(Q.STOP)}resetContext(){this.sendPlaybackControl(Q.RESET_CONTEXT)}close(){this.conn.close()}}function hl(n){const e={};return n.forEach((t,o)=>{e[o]=t}),e}function gl(n){const e=new Headers;for(const[t,o]of Object.entries(n))e.append(t,o);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yl="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Tl(n,e,t){const o=new fo;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const l=JSON.parse(s);if(n.isVertexAI()){const a=us(l);Object.assign(o,a)}else Object.assign(o,l);e(o)}class Cl{constructor(e,t,o){this.apiClient=e,this.auth=t,this.webSocketFactory=o,this.music=new pl(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,o,s,l,a,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let f;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&wt(e.config.tools)&&Dt(p);const m=Sl(p);if(this.apiClient.isVertexAI())f=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m);else{const A=this.apiClient.getApiKey();let w="BidiGenerateContent",V="key";A!=null&&A.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),w="BidiGenerateContentConstrained",V="access_token"),f=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.${w}?${V}=${A}`}let h=()=>{};const g=new Promise(A=>{h=A}),y=e.callbacks,T=function(){var A;(A=y==null?void 0:y.onopen)===null||A===void 0||A.call(y),h({})},S=this.apiClient,v={onopen:T,onmessage:A=>{Tl(S,y.onmessage,A)},onerror:(t=y==null?void 0:y.onerror)!==null&&t!==void 0?t:function(A){},onclose:(o=y==null?void 0:y.onclose)!==null&&o!==void 0?o:function(A){}},_=this.webSocketFactory.create(f,vl(m),v);_.connect(),await g;let I=N(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&I.startsWith("publishers/")){const A=this.apiClient.getProject(),w=this.apiClient.getLocation();I=`projects/${A}/locations/${w}/`+I}let R={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[me.AUDIO]}:e.config.responseModalities=[me.AUDIO]),!((l=e.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const M=(u=(a=e.config)===null||a===void 0?void 0:a.tools)!==null&&u!==void 0?u:[],P=[];for(const A of M)if(this.isCallableTool(A)){const w=A;P.push(await w.tool())}else P.push(A);P.length>0&&(e.config.tools=P);const U={model:I,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?R=is(this.apiClient,U):R=os(this.apiClient,U),delete R.config,_.send(JSON.stringify(R)),new _l(_,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const El={turnComplete:!0};class _l{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let o=[];try{o=F(t.turns),e.isVertexAI()||(o=o.map(s=>Ce(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:o,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let o=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?o=t.functionResponses:o=[t.functionResponses],o.length===0)throw new Error("functionResponses is required.");for(const l of o){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!e.isVertexAI()&&!("id"in l))throw new Error(yl)}return{toolResponse:{functionResponses:o}}}sendClientContent(e){e=Object.assign(Object.assign({},El),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:as(e)}:t={realtimeInput:ls(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function vl(n){const e={};return n.forEach((t,o)=>{e[o]=t}),e}function Sl(n){const e=new Headers;for(const[t,o]of Object.entries(n))e.append(t,o);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ot=10;function it(n){var e,t,o;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const a of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(ee(a)){s=!0;break}if(!s)return!0;const l=(o=n==null?void 0:n.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function ee(n){return"callTool"in n&&typeof n.callTool=="function"}function Il(n){var e,t,o;return(o=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>ee(s)))!==null&&o!==void 0?o:!1}function Al(n){var e,t,o;return(o=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>!ee(s)))!==null&&o!==void 0?o:!1}function st(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rl extends X{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var o,s,l,a,u;const c=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!Il(t)||it(t.config))return await this.generateContentInternal(c);if(Al(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let d,f;const p=F(c.contents),m=(l=(s=(o=c.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&l!==void 0?l:ot;let h=0;for(;h<m&&(d=await this.generateContentInternal(c),!(!d.functionCalls||d.functionCalls.length===0));){const g=d.candidates[0].content,y=[];for(const T of(u=(a=t.config)===null||a===void 0?void 0:a.tools)!==null&&u!==void 0?u:[])if(ee(T)){const v=await T.callTool(d.functionCalls);y.push(...v)}h++,f={role:"user",parts:y},c.contents=F(c.contents),c.contents.push(g),c.contents.push(f),st(c.config)&&(p.push(g),p.push(f))}return st(c.config)&&(d.automaticFunctionCallingHistory=p),d},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),it(t.config)){const o=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(o)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(o=>{var s;let l;const a=[];if(o!=null&&o.generatedImages)for(const c of o.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((s=c==null?void 0:c.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?l=c==null?void 0:c.safetyAttributes:a.push(c);let u;return l?u={generatedImages:a,positivePromptSafetyAttributes:l,sdkHttpResponse:o.sdkHttpResponse}:u={generatedImages:a,sdkHttpResponse:o.sdkHttpResponse},u}),this.list=async t=>{var o;const a={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((o=a.config)===null||o===void 0)&&o.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new fe(W.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(a),a)},this.editImage=async t=>{const o={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(o.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(o)},this.upscaleImage=async t=>{let o={numberOfImages:1,mode:"upscale"};t.config&&(o=Object.assign(Object.assign({},o),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:o};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>{if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,o,s;const l=(t=e.config)===null||t===void 0?void 0:t.tools;if(!l)return e;const a=await Promise.all(l.map(async c=>ee(c)?await c.tool():c)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:a})};if(u.config.tools=a,e.config&&e.config.tools&&wt(e.config.tools)){const c=(s=(o=e.config.httpOptions)===null||o===void 0?void 0:o.headers)!==null&&s!==void 0?s:{};let d=Object.assign({},c);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),Dt(d),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return u}async initAfcToolsMap(e){var t,o,s;const l=new Map;for(const a of(o=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&o!==void 0?o:[])if(ee(a)){const u=a,c=await u.tool();for(const d of(s=c.functionDeclarations)!==null&&s!==void 0?s:[]){if(!d.name)throw new Error("Function declaration name is required.");if(l.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);l.set(d.name,u)}}return l}async processAfcStream(e){var t,o,s;const l=(s=(o=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&s!==void 0?s:ot;let a=!1,u=0;const c=await this.initAfcToolsMap(e);return(function(d,f,p){var m,h;return j(this,arguments,function*(){for(var g,y,T,S;u<l;){a&&(u++,a=!1);const R=yield D(d.processParamsMaybeAddMcpUsage(p)),M=yield D(d.generateContentStreamInternal(R)),P=[],U=[];try{for(var v=!0,_=(y=void 0,ue(M)),I;I=yield D(_.next()),g=I.done,!g;v=!0){S=I.value,v=!1;const A=S;if(yield yield D(A),A.candidates&&(!((m=A.candidates[0])===null||m===void 0)&&m.content)){U.push(A.candidates[0].content);for(const w of(h=A.candidates[0].content.parts)!==null&&h!==void 0?h:[])if(u<l&&w.functionCall){if(!w.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(w.functionCall.name)){const V=yield D(f.get(w.functionCall.name).callTool([w.functionCall]));P.push(...V)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${w.functionCall.name}`)}}}}catch(A){y={error:A}}finally{try{!v&&!g&&(T=_.return)&&(yield D(T.call(_)))}finally{if(y)throw y.error}}if(P.length>0){a=!0;const A=new re;A.candidates=[{content:{role:"user",parts:P}}],yield yield D(A);const w=[];w.push(...U),w.push({role:"user",parts:P});const V=F(p.contents).concat(w);p.contents=V}else break}})})(this,c,e)}async generateContentInternal(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=On(this.apiClient,e);return u=E("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=et(f),m=new re;return Object.assign(m,p),m})}else{const d=Zn(this.apiClient,e);return u=E("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=jn(f),m=new re;return Object.assign(m,p),m})}}async generateContentStreamInternal(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=On(this.apiClient,e);return u=E("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),a.then(function(p){return j(this,arguments,function*(){var m,h,g,y;try{for(var T=!0,S=ue(p),v;v=yield D(S.next()),m=v.done,!m;T=!0){y=v.value,T=!1;const _=y,I=et(yield D(_.json()));I.sdkHttpResponse={headers:_.headers};const R=new re;Object.assign(R,I),yield yield D(R)}}catch(_){h={error:_}}finally{try{!T&&!m&&(g=S.return)&&(yield D(g.call(S)))}finally{if(h)throw h.error}}})})}else{const d=Zn(this.apiClient,e);return u=E("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}),a.then(function(p){return j(this,arguments,function*(){var m,h,g,y;try{for(var T=!0,S=ue(p),v;v=yield D(S.next()),m=v.done,!m;T=!0){y=v.value,T=!1;const _=y,I=jn(yield D(_.json()));I.sdkHttpResponse={headers:_.headers};const R=new re;Object.assign(R,I),yield yield D(R)}}catch(_){h={error:_}}finally{try{!T&&!m&&(g=S.return)&&(yield D(g.call(S)))}finally{if(h)throw h.error}}})})}}async embedContent(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Gs(this.apiClient,e);return u=E("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=Hs(f),m=new Un;return Object.assign(m,p),m})}else{const d=Fs(this.apiClient,e);return u=E("{model}:batchEmbedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=bs(f),m=new Un;return Object.assign(m,p),m})}}async generateImagesInternal(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Qs(this.apiClient,e);return u=E("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=Os(f),m=new qn;return Object.assign(m,p),m})}else{const d=Xs(this.apiClient,e);return u=E("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=Zs(f),m=new qn;return Object.assign(m,p),m})}}async editImageInternal(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Ls(this.apiClient,e);return l=E("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=Us(c),f=new oo;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Kr(this.apiClient,e);return l=E("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=Wr(c),f=new io;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Pr(this.apiClient,e);return l=E("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=Nr(c),f=new so;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Ur(this.apiClient,e);return l=E("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=qr(c),f=new ro;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=hr(this.apiClient,e);return u=E("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>ke(f))}else{const d=mr(this.apiClient,e);return u=E("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>De(f))}}async listInternal(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=_r(this.apiClient,e);return u=E("{models_url}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=Sr(f),m=new Vn;return Object.assign(m,p),m})}else{const d=Er(this.apiClient,e);return u=E("{models_url}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=vr(f),m=new Vn;return Object.assign(m,p),m})}}async update(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=$r(this.apiClient,e);return u=E("{model}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>ke(f))}else{const d=Jr(this.apiClient,e);return u=E("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>De(f))}}async delete(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ws(this.apiClient,e);return u=E("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=ks(f),m=new Fn;return Object.assign(m,p),m})}else{const d=Ns(this.apiClient,e);return u=E("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=Ds(f),m=new Fn;return Object.assign(m,p),m})}}async countTokens(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Rs(this.apiClient,e);return u=E("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=Ps(f),m=new Gn;return Object.assign(m,p),m})}else{const d=As(this.apiClient,e);return u=E("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=Ms(f),m=new Gn;return Object.assign(m,p),m})}}async computeTokens(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Ts(this.apiClient,e);return l=E("{model}:computeTokens",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=Cs(c),f=new lo;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ir(this.apiClient,e);return u=E("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>{const p=tr(f),m=new he;return Object.assign(m,p),m})}else{const d=or(this.apiClient,e);return u=E("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=nr(f),m=new he;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ml extends X{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,o=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let l;o&&"httpOptions"in o&&(l=o.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:a,isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:o});return t._fromAPIResponse({apiResponse:s,isVertexAI:!1})}}async get(e){const t=e.operation,o=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let l;o&&"httpOptions"in o&&(l=o.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:a,isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:o});return t._fromAPIResponse({apiResponse:s,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=eo(e);return u=E("{operationName}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a}else{const d=jt(e);return u=E("{operationName}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a}}async fetchPredictVideosOperationInternal(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Kt(e);return l=E("{resourceName}:fetchPredictOperation",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pl(n){const e={};if(i(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=i(n,["data"]);t!=null&&r(e,["data"],t);const o=i(n,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function Nl(n){const e={},t=i(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>ql(l))),r(e,["parts"],s)}const o=i(n,["role"]);return o!=null&&r(e,["role"],o),e}function wl(n,e,t){const o={},s=i(e,["expireTime"]);t!==void 0&&s!=null&&r(t,["expireTime"],s);const l=i(e,["newSessionExpireTime"]);t!==void 0&&l!=null&&r(t,["newSessionExpireTime"],l);const a=i(e,["uses"]);t!==void 0&&a!=null&&r(t,["uses"],a);const u=i(e,["liveConnectConstraints"]);t!==void 0&&u!=null&&r(t,["bidiGenerateContentSetup"],Ul(n,u));const c=i(e,["lockAdditionalFields"]);return t!==void 0&&c!=null&&r(t,["fieldMask"],c),o}function Dl(n,e){const t={},o=i(e,["config"]);return o!=null&&r(t,["config"],wl(n,o,t)),t}function kl(n){const e={};if(i(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=i(n,["fileUri"]);t!=null&&r(e,["fileUri"],t);const o=i(n,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function xl(n){const e={},t=i(n,["timeRangeFilter"]);if(t!=null&&r(e,["timeRangeFilter"],t),i(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function Ll(n,e){const t={},o=i(n,["generationConfig"]);e!==void 0&&o!=null&&r(e,["setup","generationConfig"],o);const s=i(n,["responseModalities"]);e!==void 0&&s!=null&&r(e,["setup","generationConfig","responseModalities"],s);const l=i(n,["temperature"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","temperature"],l);const a=i(n,["topP"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","topP"],a);const u=i(n,["topK"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topK"],u);const c=i(n,["maxOutputTokens"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","maxOutputTokens"],c);const d=i(n,["mediaResolution"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","mediaResolution"],d);const f=i(n,["seed"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","seed"],f);const p=i(n,["speechConfig"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","speechConfig"],Ge(p));const m=i(n,["thinkingConfig"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","thinkingConfig"],m);const h=i(n,["enableAffectiveDialog"]);e!==void 0&&h!=null&&r(e,["setup","generationConfig","enableAffectiveDialog"],h);const g=i(n,["systemInstruction"]);e!==void 0&&g!=null&&r(e,["setup","systemInstruction"],Nl(q(g)));const y=i(n,["tools"]);if(e!==void 0&&y!=null){let M=oe(y);Array.isArray(M)&&(M=M.map(P=>Fl(te(P)))),r(e,["setup","tools"],M)}const T=i(n,["sessionResumption"]);e!==void 0&&T!=null&&r(e,["setup","sessionResumption"],Vl(T));const S=i(n,["inputAudioTranscription"]);e!==void 0&&S!=null&&r(e,["setup","inputAudioTranscription"],S);const v=i(n,["outputAudioTranscription"]);e!==void 0&&v!=null&&r(e,["setup","outputAudioTranscription"],v);const _=i(n,["realtimeInputConfig"]);e!==void 0&&_!=null&&r(e,["setup","realtimeInputConfig"],_);const I=i(n,["contextWindowCompression"]);e!==void 0&&I!=null&&r(e,["setup","contextWindowCompression"],I);const R=i(n,["proactivity"]);return e!==void 0&&R!=null&&r(e,["setup","proactivity"],R),t}function Ul(n,e){const t={},o=i(e,["model"]);o!=null&&r(t,["setup","model"],N(n,o));const s=i(e,["config"]);return s!=null&&r(t,["config"],Ll(s,t)),t}function ql(n){const e={},t=i(n,["videoMetadata"]);t!=null&&r(e,["videoMetadata"],t);const o=i(n,["thought"]);o!=null&&r(e,["thought"],o);const s=i(n,["inlineData"]);s!=null&&r(e,["inlineData"],Pl(s));const l=i(n,["fileData"]);l!=null&&r(e,["fileData"],kl(l));const a=i(n,["thoughtSignature"]);a!=null&&r(e,["thoughtSignature"],a);const u=i(n,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=i(n,["codeExecutionResult"]);c!=null&&r(e,["codeExecutionResult"],c);const d=i(n,["executableCode"]);d!=null&&r(e,["executableCode"],d);const f=i(n,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=i(n,["text"]);return p!=null&&r(e,["text"],p),e}function Vl(n){const e={},t=i(n,["handle"]);if(t!=null&&r(e,["handle"],t),i(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Fl(n){const e={},t=i(n,["functionDeclarations"]);if(t!=null){let c=t;Array.isArray(c)&&(c=c.map(d=>d)),r(e,["functionDeclarations"],c)}if(i(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=i(n,["googleSearch"]);o!=null&&r(e,["googleSearch"],xl(o));const s=i(n,["googleSearchRetrieval"]);if(s!=null&&r(e,["googleSearchRetrieval"],s),i(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(i(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=i(n,["urlContext"]);l!=null&&r(e,["urlContext"],l);const a=i(n,["computerUse"]);a!=null&&r(e,["computerUse"],a);const u=i(n,["codeExecution"]);return u!=null&&r(e,["codeExecution"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gl(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const o=n[t];if(typeof o=="object"&&o!=null&&Object.keys(o).length>0){const s=Object.keys(o).map(l=>`${t}.${l}`);e.push(...s)}else e.push(t)}return e.join(",")}function bl(n,e){let t=null;const o=n.bidiGenerateContentSetup;if(typeof o=="object"&&o!==null&&"setup"in o){const l=o.setup;typeof l=="object"&&l!==null?(n.bidiGenerateContentSetup=l,t=l):delete n.bidiGenerateContentSetup}else o!==void 0&&delete n.bidiGenerateContentSetup;const s=n.fieldMask;if(t){const l=Gl(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)l?n.fieldMask=l:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const a=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];s.length>0&&(u=s.map(d=>a.includes(d)?`generationConfig.${d}`:d));const c=[];l&&c.push(l),u.length>0&&c.push(...u),c.length>0?n.fieldMask=c.join(","):delete n.fieldMask}else delete n.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?n.fieldMask=s.join(","):delete n.fieldMask;return n}class Hl extends X{constructor(e){super(),this.apiClient=e}async create(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=Dl(this.apiClient,e);l=E("auth_tokens",u._url),a=u._query,delete u.config,delete u._url,delete u._query;const c=bl(u,e.config);return s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),s.then(d=>d)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bl(n){const e={},t=i(n,["name"]);return t!=null&&r(e,["_url","name"],t),e}function Jl(n){const e={},t=i(n,["name"]);return t!=null&&r(e,["_url","name"],t),e}function $l(n,e){const t={};if(i(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const o=i(n,["tunedModelDisplayName"]);if(e!==void 0&&o!=null&&r(e,["displayName"],o),i(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=i(n,["epochCount"]);e!==void 0&&s!=null&&r(e,["tuningTask","hyperparameters","epochCount"],s);const l=i(n,["learningRateMultiplier"]);if(l!=null&&r(t,["tuningTask","hyperparameters","learningRateMultiplier"],l),i(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(i(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(i(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=i(n,["batchSize"]);e!==void 0&&a!=null&&r(e,["tuningTask","hyperparameters","batchSize"],a);const u=i(n,["learningRate"]);if(e!==void 0&&u!=null&&r(e,["tuningTask","hyperparameters","learningRate"],u),i(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return t}function Yl(n,e){const t={},o=i(n,["validationDataset"]);e!==void 0&&o!=null&&r(e,["supervisedTuningSpec"],ra(o,t));const s=i(n,["tunedModelDisplayName"]);e!==void 0&&s!=null&&r(e,["tunedModelDisplayName"],s);const l=i(n,["description"]);e!==void 0&&l!=null&&r(e,["description"],l);const a=i(n,["epochCount"]);e!==void 0&&a!=null&&r(e,["supervisedTuningSpec","hyperParameters","epochCount"],a);const u=i(n,["learningRateMultiplier"]);e!==void 0&&u!=null&&r(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const c=i(n,["exportLastCheckpointOnly"]);e!==void 0&&c!=null&&r(e,["supervisedTuningSpec","exportLastCheckpointOnly"],c);const d=i(n,["adapterSize"]);if(e!==void 0&&d!=null&&r(e,["supervisedTuningSpec","hyperParameters","adapterSize"],d),i(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(i(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const f=i(n,["labels"]);return e!==void 0&&f!=null&&r(e,["labels"],f),t}function Kl(n){const e={},t=i(n,["baseModel"]);t!=null&&r(e,["baseModel"],t);const o=i(n,["preTunedModel"]);o!=null&&r(e,["preTunedModel"],o);const s=i(n,["trainingDataset"]);s!=null&&r(e,["tuningTask","trainingData"],oa(s));const l=i(n,["config"]);return l!=null&&$l(l,e),e}function Wl(n){const e={},t=i(n,["baseModel"]);t!=null&&r(e,["baseModel"],t);const o=i(n,["preTunedModel"]);o!=null&&r(e,["preTunedModel"],o);const s=i(n,["trainingDataset"]);s!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],ia(s,e));const l=i(n,["config"]);return l!=null&&Yl(l,e),e}function zl(n){const e={},t=i(n,["name"]);return t!=null&&r(e,["_url","name"],t),e}function Xl(n){const e={},t=i(n,["name"]);return t!=null&&r(e,["_url","name"],t),e}function Ql(n,e){const t={},o=i(n,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(n,["pageToken"]);e!==void 0&&s!=null&&r(e,["_query","pageToken"],s);const l=i(n,["filter"]);return e!==void 0&&l!=null&&r(e,["_query","filter"],l),t}function Zl(n,e){const t={},o=i(n,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(n,["pageToken"]);e!==void 0&&s!=null&&r(e,["_query","pageToken"],s);const l=i(n,["filter"]);return e!==void 0&&l!=null&&r(e,["_query","filter"],l),t}function Ol(n){const e={},t=i(n,["config"]);return t!=null&&Ql(t,e),e}function jl(n){const e={},t=i(n,["config"]);return t!=null&&Zl(t,e),e}function ea(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(n,["tunedModels"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>kt(a))),r(e,["tuningJobs"],l)}return e}function na(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(n,["tuningJobs"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>Le(a))),r(e,["tuningJobs"],l)}return e}function ta(n){const e={},t=i(n,["name"]);t!=null&&r(e,["model"],t);const o=i(n,["name"]);return o!=null&&r(e,["endpoint"],o),e}function oa(n){const e={};if(i(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(i(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=i(n,["examples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>s)),r(e,["examples","examples"],o)}return e}function ia(n,e){const t={},o=i(n,["gcsUri"]);e!==void 0&&o!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],o);const s=i(n,["vertexDatasetResource"]);if(e!==void 0&&s!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],s),i(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function kt(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["name"]);o!=null&&r(e,["name"],o);const s=i(n,["state"]);s!=null&&r(e,["state"],pt(s));const l=i(n,["createTime"]);l!=null&&r(e,["createTime"],l);const a=i(n,["tuningTask","startTime"]);a!=null&&r(e,["startTime"],a);const u=i(n,["tuningTask","completeTime"]);u!=null&&r(e,["endTime"],u);const c=i(n,["updateTime"]);c!=null&&r(e,["updateTime"],c);const d=i(n,["description"]);d!=null&&r(e,["description"],d);const f=i(n,["baseModel"]);f!=null&&r(e,["baseModel"],f);const p=i(n,["_self"]);p!=null&&r(e,["tunedModel"],ta(p));const m=i(n,["customBaseModel"]);m!=null&&r(e,["customBaseModel"],m);const h=i(n,["experiment"]);h!=null&&r(e,["experiment"],h);const g=i(n,["labels"]);g!=null&&r(e,["labels"],g);const y=i(n,["outputUri"]);y!=null&&r(e,["outputUri"],y);const T=i(n,["pipelineJob"]);T!=null&&r(e,["pipelineJob"],T);const S=i(n,["serviceAccount"]);S!=null&&r(e,["serviceAccount"],S);const v=i(n,["tunedModelDisplayName"]);v!=null&&r(e,["tunedModelDisplayName"],v);const _=i(n,["veoTuningSpec"]);return _!=null&&r(e,["veoTuningSpec"],_),e}function Le(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["name"]);o!=null&&r(e,["name"],o);const s=i(n,["state"]);s!=null&&r(e,["state"],pt(s));const l=i(n,["createTime"]);l!=null&&r(e,["createTime"],l);const a=i(n,["startTime"]);a!=null&&r(e,["startTime"],a);const u=i(n,["endTime"]);u!=null&&r(e,["endTime"],u);const c=i(n,["updateTime"]);c!=null&&r(e,["updateTime"],c);const d=i(n,["error"]);d!=null&&r(e,["error"],d);const f=i(n,["description"]);f!=null&&r(e,["description"],f);const p=i(n,["baseModel"]);p!=null&&r(e,["baseModel"],p);const m=i(n,["tunedModel"]);m!=null&&r(e,["tunedModel"],m);const h=i(n,["preTunedModel"]);h!=null&&r(e,["preTunedModel"],h);const g=i(n,["supervisedTuningSpec"]);g!=null&&r(e,["supervisedTuningSpec"],g);const y=i(n,["tuningDataStats"]);y!=null&&r(e,["tuningDataStats"],y);const T=i(n,["encryptionSpec"]);T!=null&&r(e,["encryptionSpec"],T);const S=i(n,["partnerModelTuningSpec"]);S!=null&&r(e,["partnerModelTuningSpec"],S);const v=i(n,["customBaseModel"]);v!=null&&r(e,["customBaseModel"],v);const _=i(n,["experiment"]);_!=null&&r(e,["experiment"],_);const I=i(n,["labels"]);I!=null&&r(e,["labels"],I);const R=i(n,["outputUri"]);R!=null&&r(e,["outputUri"],R);const M=i(n,["pipelineJob"]);M!=null&&r(e,["pipelineJob"],M);const P=i(n,["serviceAccount"]);P!=null&&r(e,["serviceAccount"],P);const U=i(n,["tunedModelDisplayName"]);U!=null&&r(e,["tunedModelDisplayName"],U);const A=i(n,["veoTuningSpec"]);return A!=null&&r(e,["veoTuningSpec"],A),e}function sa(n){const e={},t=i(n,["sdkHttpResponse"]);t!=null&&r(e,["sdkHttpResponse"],t);const o=i(n,["name"]);o!=null&&r(e,["name"],o);const s=i(n,["metadata"]);s!=null&&r(e,["metadata"],s);const l=i(n,["done"]);l!=null&&r(e,["done"],l);const a=i(n,["error"]);return a!=null&&r(e,["error"],a),e}function ra(n,e){const t={},o=i(n,["gcsUri"]);o!=null&&r(t,["validationDatasetUri"],o);const s=i(n,["vertexDatasetResource"]);return e!==void 0&&s!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],s),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class la extends X{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new fe(W.PAGED_ITEM_TUNING_JOBS,o=>this.listInternal(o),await this.listInternal(t),t),this.tune=async t=>{var o;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel};!((o=t.config)===null||o===void 0)&&o.preTunedModelCheckpointId&&(s.checkpointId=t.config.preTunedModelCheckpointId);const l=Object.assign(Object.assign({},t),{preTunedModel:s});return l.baseModel=void 0,await this.tuneInternal(l)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),l=await this.tuneMldevInternal(s);let a="";return l.metadata!==void 0&&l.metadata.tunedModel!==void 0?a=l.metadata.tunedModel:l.name!==void 0&&l.name.includes("/operations/")&&(a=l.name.split("/operations/")[0]),{name:a,state:Me.JOB_STATE_QUEUED}}}}async getInternal(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Xl(e);return u=E("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>Le(f))}else{const d=zl(e);return u=E("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>kt(f))}}async listInternal(e){var t,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=jl(e);return u=E("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=na(f),m=new bn;return Object.assign(m,p),m})}else{const d=Ol(e);return u=E("tunedModels",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),a.then(f=>{const p=ea(f),m=new bn;return Object.assign(m,p),m})}}async cancel(e){var t,o,s,l;let a="",u={};if(this.apiClient.isVertexAI()){const c=Jl(e);a=E("{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}else{const c=Bl(e);a=E("{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async tuneInternal(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Wl(e);return l=E("tuningJobs",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>Le(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Kl(e);return l=E("tunedModels",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>sa(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aa{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const ua=1024*1024*8,da=3,ca=1e3,fa=2,Re="x-goog-upload-status";async function pa(n,e,t){var o,s,l;let a=0,u=0,c=new Pe(new Response),d="upload";for(a=n.size;u<a;){const p=Math.min(ua,a-u),m=n.slice(u,u+p);u+p>=a&&(d+=", finalize");let h=0,g=ca;for(;h<da&&(c=await t.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(u),"Content-Length":String(p)}}}),!(!((o=c==null?void 0:c.headers)===null||o===void 0)&&o[Re]));)h++,await ha(g),g=g*fa;if(u+=p,((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s[Re])!=="active")break;if(a<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(c==null?void 0:c.json());if(((l=c==null?void 0:c.headers)===null||l===void 0?void 0:l[Re])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function ma(n){return{size:n.size,type:n.type}}function ha(n){return new Promise(e=>setTimeout(e,n))}class ga{async upload(e,t,o){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await pa(e,t,o)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await ma(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ya{create(e,t,o){return new Ta(e,t,o)}}class Ta{constructor(e,t,o){this.url=e,this.headers=t,this.callbacks=o}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rt="x-goog-api-key";class Ca{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(rt)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(rt,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ea="gl-node/";class _a{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const o=Yt(e.httpOptions,e.vertexai,void 0,void 0);o&&(e.httpOptions?e.httpOptions.baseUrl=o:e.httpOptions={baseUrl:o}),this.apiVersion=e.apiVersion;const s=new Ca(this.apiKey);this.apiClient=new rl({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:Ea+"web",uploader:new ga,downloader:new aa}),this.models=new Rl(this.apiClient),this.live=new Cl(this.apiClient,s,new ya),this.batches=new ai(this.apiClient),this.chats=new Gi(this.models,this.apiClient),this.caches=new qi(this.apiClient),this.files=new Xi(this.apiClient),this.operations=new Ml(this.apiClient),this.authTokens=new Hl(this.apiClient),this.tunings=new la(this.apiClient)}}const xt=3,lt={member:{9:200,18:350},nonMember:{9:250,18:425}},va=50,Sa=7,ve={9:135,18:270},Se={9:30,18:60},Ia=24,Lt="golfCartControlState",Aa=new _a({apiKey:"PLACEHOLDER_API_KEY"});var Ut=(n=>(n.Vipps="Vipps",n.Card="Kort",n.Cash="Kontant",n.ClubCredit="Klubbkreditt",n))(Ut||{});let k=Ma();const qt=window.location.pathname.includes("/csadmin/");let Z="dashboard",C={date:new Date().toISOString().split("T")[0],time:"10:00",holes:18,name:"",isMember:!1,membershipNumber:"",hasDoctorsNote:!1,notificationMethod:"email",contactInfo:"",availability:{checked:!1,availableCarts:0},isSubmitting:!1},ye="",H={column:"endTime",direction:"desc"},J={conversation:[{role:"model",text:"Hei! Jeg er Golfy, din AI-assistent. Spr meg om bookinger, omsetning eller bilstatus."}],isLoading:!1};function Ra(){return{carts:Array.from({length:xt},(n,e)=>({id:e+1,status:"available",currentRentalId:null})),rentals:[]}}function Ma(){try{const n=localStorage.getItem(Lt);if(n){const e=JSON.parse(n);if(e.carts&&e.carts.length===xt)return e.rentals.forEach(t=>{t.reminderSent===void 0&&(t.reminderSent=!1),t.membershipNumber===void 0&&(t.membershipNumber=null)}),e}}catch(n){console.error("Failed to load state from localStorage:",n)}return Ra()}function se(){try{localStorage.setItem(Lt,JSON.stringify(k))}catch(n){console.error("Failed to save state to localStorage:",n)}}async function Vt(n,e,t){return console.log("--- SIMULATING NOTIFICATION ---"),console.log(`Type: ${n.toUpperCase()}`),console.log(`To: ${e}`),console.log(`Message: ${t}`),console.log("-------------------------------"),await new Promise(o=>setTimeout(o,1e3)),!0}function z(n){return n?new Date(n).toLocaleString("nb-NO",{dateStyle:"short",timeStyle:"short"}):"Pgende"}function ce(n,e,t){const o=n?lt.member[t]:lt.nonMember[t];return Math.max(0,o-(e?va:0))}function Ft(n){const e=new Date(n.startTime),t=ve[n.holes]+Se[n.holes];return new Date(e.getTime()+t*60*1e3)}function Gt(){const n=new Date(`${C.date}T${C.time}`),e=ve[C.holes],t=Se[C.holes],o=new Date(n.getTime()+(e+t)*60*1e3),s=k.carts.filter(l=>l.status==="out_of_order"?!1:k.rentals.filter(u=>{if(u.cartId!==l.id)return!1;const c=new Date(u.startTime),d=Ft(u);return n<d&&o>c}).length===0);C.availability={checked:!0,availableCarts:s.length},L()}const de=document.getElementById("root");function L(){de.innerHTML="",qt?(de.className="golfbil-admin-app",Pa()):(de.className="golfbil-app",Na())}function bt(n){const e=document.createElement("header");return e.innerHTML=`
      <button id="info-btn" aria-label="Vis informasjon">&quest;</button>
      <h1>${n}</h1>
      <p>Ski Golfklubb</p>`,e.querySelector("#info-btn").addEventListener("click",Va),e}function Pa(){const n=document.createDocumentFragment();n.appendChild(bt("Golfbilkontroll")),n.appendChild(wa());const e=document.createElement("main");Z==="dashboard"?Da(e):Ht(e),n.appendChild(e),de.appendChild(n)}function Na(){const n=document.createDocumentFragment();n.appendChild(bt("Book Golfbil"));const e=document.createElement("main");Ht(e),n.appendChild(e),de.appendChild(n)}function wa(){const n=document.createElement("nav");n.className="golfbil-main-nav";const e=document.createElement("button");e.textContent="Dashboard",e.className=`golfbil-nav-item ${Z==="dashboard"?"active":""}`,e.onclick=()=>{Z="dashboard",L()};const t=document.createElement("button");return t.textContent="Booking",t.className=`golfbil-nav-item ${Z==="booking"?"active":""}`,t.onclick=()=>{Z="booking",L()},n.appendChild(e),n.appendChild(t),n}function Da(n){ka(n),xa(n);const e=document.createElement("section");e.innerHTML="<h2>Bilpark Oversikt</h2>";const t=document.createElement("div");t.className="golfbil-cart-grid",k.carts.forEach(d=>t.appendChild(La(d))),e.appendChild(t),n.appendChild(e);const o=document.createElement("section"),s=document.createElement("div");s.className="log-header",s.innerHTML="<h2>Utleiehistorikk</h2>";const l=document.createElement("div");l.className="history-controls";const a=document.createElement("input");a.type="text",a.placeholder="Sk p navn/medlemsnr...",a.setAttribute("aria-label","Sk etter leietaker i historikken"),a.value=ye,a.oninput=d=>{ye=d.target.value,L()},l.appendChild(a);const u=document.createElement("button");u.className="golfbil-btn btn-primary",u.textContent="Eksporter til CSV",u.onclick=Wa,l.appendChild(u),s.appendChild(l),o.appendChild(s);const c=document.createElement("div");c.className="table-wrapper",c.appendChild(Ua()),o.appendChild(c),n.appendChild(o)}function ka(n){const e=document.createElement("section");e.className="golfbil-ai-assistant",e.innerHTML="<h2>AI Assistent</h2>";const t=document.createElement("div");if(t.className="golfbil-chat-history",J.conversation.forEach(a=>{const u=document.createElement("div");u.className=`chat-message ${a.role}-message`,u.innerHTML=a.text.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),t.appendChild(u)}),J.isLoading){const a=document.createElement("div");a.className="chat-message model-message thinking-indicator",a.textContent="Tenker...",t.appendChild(a)}setTimeout(()=>{t.scrollTop=t.scrollHeight},0);const o=document.createElement("form");o.className="golfbil-ai-input-form",o.onsubmit=Ga;const s=document.createElement("input");s.type="text",s.name="prompt",s.placeholder="Still et sprsml...",s.required=!0,s.disabled=J.isLoading;const l=document.createElement("button");l.type="submit",l.className="golfbil-btn btn-primary",l.textContent="Send",l.disabled=J.isLoading,o.appendChild(s),o.appendChild(l),e.appendChild(t),e.appendChild(o),n.appendChild(e)}function xa(n){const e=new Date,t=new Date(e.getTime()+Ia*60*60*1e3),o=k.rentals.filter(u=>!u.reminderSent&&u.endTime===null&&new Date(u.startTime)>e&&new Date(u.startTime)<t);if(o.length===0)return;const s=document.createElement("section");s.innerHTML="<h2>Utsendelse av pminnelser</h2>";const l=document.createElement("table");l.className="rental-log-table",l.innerHTML=`
        <thead>
            <tr>
                <th>Leietaker</th>
                <th>Bookingtid</th>
                <th>Kontaktinfo</th>
                <th>Handling</th>
            </tr>
        </thead>
    `;const a=document.createElement("tbody");o.forEach(u=>{const c=document.createElement("tr");c.innerHTML=`
            <td>${u.renterName}</td>
            <td>${z(u.startTime)}</td>
            <td>${u.contactInfo} (${u.notificationMethod})</td>
        `;const d=document.createElement("td"),f=document.createElement("button");f.className="golfbil-btn btn-secondary",f.textContent="Send pminnelse",f.onclick=()=>Ka(u.id),d.appendChild(f),c.appendChild(d),a.appendChild(c)}),l.appendChild(a),s.appendChild(l),n.appendChild(s)}function La(n){const e=document.createElement("div");e.className=`cart-card status-${n.status}`;const t=document.createElement("div");t.className=`card-header status-${n.status}`,t.innerHTML=`<h3>Bil ${n.id}</h3>`;const o=document.createElement("div");o.className="golfbil-card-body";const s=document.createElement("div");s.className="card-footer";const l=k.rentals.filter(a=>a.cartId===n.id&&new Date(a.startTime)>new Date&&a.endTime===null).sort((a,u)=>new Date(a.startTime).getTime()-new Date(u.startTime).getTime())[0];switch(n.status){case"available":o.innerHTML="<p>Ledig</p>",l&&(o.innerHTML+=`<p class="upcoming-booking">Neste: ${z(l.startTime)}</p>`);const a=document.createElement("button");a.className="golfbil-btn btn-success",a.textContent="Start utleie",a.onclick=()=>Fa(n.id),s.appendChild(a);break;case"rented":const u=k.rentals.find(f=>f.id===n.currentRentalId);o.innerHTML=`<p>Utleid til: <strong>${(u==null?void 0:u.renterName)||"Ukjent"}</strong></p>`;const c=document.createElement("button");c.className="golfbil-btn btn-warning",c.textContent="Sett som returnert",c.onclick=()=>Ja(n.id),s.appendChild(c);break;case"out_of_order":o.innerHTML="<p>Ute av drift</p>";const d=document.createElement("button");d.className="golfbil-btn btn-secondary",d.textContent="Sett som tilgjengelig",d.onclick=()=>Ya(n.id),s.appendChild(d);break}if(n.status!=="out_of_order"){const a=document.createElement("button");a.className="golfbil-btn btn-danger",a.textContent="Sett ute av drift",a.onclick=()=>$a(n.id),s.appendChild(a)}return e.appendChild(t),e.appendChild(o),e.appendChild(s),e}function Ua(){const n=document.createElement("table");n.className="rental-log-table";const e=k.rentals.filter(f=>f.endTime),t=ye.toLowerCase(),o=ye?e.filter(f=>f.renterName.toLowerCase().includes(t)||f.membershipNumber&&f.membershipNumber.includes(t)):e;o.sort((f,p)=>{const m=f[H.column],h=p[H.column];if(m===h)return 0;if(m===null)return 1;if(h===null)return-1;const g=m>h?1:-1;return H.direction==="desc"?-g:g});const s=f=>H.column===f?H.direction==="desc"?" ":" ":"",l=(f,p)=>{const m=document.createElement("th");return m.textContent=f+s(p),m.dataset.sortKey=p,m.onclick=()=>ba(p),m},a=document.createElement("thead"),u=document.createElement("tr");u.appendChild(l("Bil ID","cartId")),u.appendChild(l("Leietaker","renterName")),u.appendChild(l("Medlemsnr.","membershipNumber")),u.appendChild(l("Starttid","startTime")),u.appendChild(l("Returtid","endTime")),u.appendChild(l("Pris","price"));const c=document.createElement("th");c.textContent="Status",u.appendChild(c),a.appendChild(u),n.appendChild(a);const d=document.createElement("tbody");return o.length===0?d.innerHTML='<tr><td colspan="7" style="text-align:center;">Ingen avsluttede utleier funnet.</td></tr>':o.forEach(f=>{const p=document.createElement("tr");p.innerHTML=`
                <td>${f.cartId}</td>
                <td>${f.renterName}</td>
                <td>${f.membershipNumber||""}</td>
                <td>${z(f.startTime)}</td>
                <td>${f.endTime?z(f.endTime):""}</td>
                <td>${f.price!==null?`${f.price},-`:"N/A"}</td>
                <td>Avsluttet</td>
            `,d.appendChild(p)}),n.appendChild(d),n}function qa(n){const s=document.createElement("div");s.className="availability-view",s.innerHTML=`<h3>Tilgjengelighet for ${new Date(n+"T00:00:00").toLocaleDateString("nb-NO",{weekday:"long",day:"numeric",month:"long"})}</h3>`;const l=document.createElement("div");l.className="availability-grid",l.appendChild(document.createElement("div"));for(let a=10;a<19.5;a++){const u=document.createElement("div");u.className="time-header",u.textContent=`${a.toString().padStart(2,"0")}:00`,u.style.gridColumn="span 2",l.appendChild(u)}return k.carts.forEach(a=>{const u=document.createElement("div");u.className="cart-label",u.textContent=`Bil ${a.id}`,l.appendChild(u);const c=document.createElement("div");c.className="cart-row",l.appendChild(c),k.rentals.filter(f=>f.cartId===a.id&&new Date(f.startTime).toISOString().split("T")[0]===n).forEach(f=>{const p=new Date(f.startTime),m=p.getHours()*60+p.getMinutes(),g=Math.max(0,m-600),y=ve[f.holes]+Se[f.holes],T=g/30+1,S=y/30;if(T>(19.5-10)*2)return;const v=document.createElement("div");v.className="booking-block",v.textContent=f.renterName,v.title=`${f.renterName} - ${f.holes} hull
Start: ${p.toLocaleTimeString("nb-NO",{timeStyle:"short"})}`,v.style.gridColumn=`${T} / span ${S}`,c.appendChild(v)})}),s.appendChild(l),s}function Ht(n){const e=document.createElement("section");e.innerHTML="<h2>Book en Golfbil</h2>",e.appendChild(qa(C.date));const t=document.createElement("form");t.className="booking-form",t.onsubmit=y=>Ha(y,t),t.onchange=()=>{ae(t);const y=ce(C.isMember,C.hasDoctorsNote,C.holes);t.querySelector(".price-estimate").textContent=`Estimert pris: ${y},-`};const o=new Date,s=new Date;s.setDate(o.getDate()+Sa);const l=o.toISOString().split("T")[0],a=s.toISOString().split("T")[0],u=C.notificationMethod==="email"?"email":"tel",c=C.notificationMethod==="email"?"E-post":"Telefonnummer",d=C.notificationMethod==="email"?"navn@eksempel.com":"12345678";let f="";for(let y=10;y<=19;y++){const T=y.toString().padStart(2,"0");f+=`<option value="${T}:00" ${C.time===`${T}:00`?"selected":""}>${T}:00</option>`,y<19&&(f+=`<option value="${T}:30" ${C.time===`${T}:30`?"selected":""}>${T}:30</option>`)}const p=ce(C.isMember,C.hasDoctorsNote,C.holes);t.innerHTML=`
        <div class="form-group">
            <label for="booking-name">Fullt navn</label>
            <input type="text" id="booking-name" required value="${C.name}">
        </div>
        <div class="form-group membership-group">
            <label for="booking-membership-number">Medlemsnummer</label>
            <input type="text" id="booking-membership-number" placeholder="f.eks. 73-12345" value="${C.membershipNumber}" required>
        </div>
        <div class="form-group">
            <label class="checkbox-group">
                <input type="checkbox" id="booking-has-doctors-note" ${C.hasDoctorsNote?"checked":""}> Legeerklring (50,- i rabatt)
            </label>
        </div>
        <div class="form-group">
            <label for="booking-date">Dato</label>
            <input type="date" id="booking-date" value="${C.date}" min="${l}" max="${a}" required>
        </div>
        <div class="form-group">
            <label for="booking-time">Starttid</label>
            <select id="booking-time" required>
                ${f}
            </select>
        </div>
        <div class="form-group">
            <label for="booking-holes">Runde</label>
            <select id="booking-holes" required>
                <option value="18" ${C.holes===18?"selected":""}>18 hull</option>
                <option value="9" ${C.holes===9?"selected":""}>9 hull</option>
            </select>
        </div>
        <hr>
        <div class="form-group">
            <label>Varslingsmetode for bekreftelse</label>
            <div class="radio-group">
                <label><input type="radio" name="notificationMethod" value="email" ${C.notificationMethod==="email"?"checked":""}> E-post</label>
                <label><input type="radio" name="notificationMethod" value="sms" ${C.notificationMethod==="sms"?"checked":""}> SMS</label>
            </div>
        </div>
        <div class="form-group">
            <label for="contact-info">${c}</label>
            <input type="${u}" id="contact-info" placeholder="${d}" required value="${C.contactInfo}">
        </div>
        <div class="price-estimate">${`Estimert pris: ${p},-`}</div>
    `;const m=t.querySelector("#booking-date");m.onchange=()=>{ae(t),C.availability.checked=!1,L()};const h=document.createElement("div");h.className="availability-result";const g=document.createElement("button");if(g.type="button",g.className="golfbil-btn btn-secondary",g.textContent="Sjekk tilgjengelighet",g.onclick=()=>{ae(t),Gt()},t.appendChild(g),t.querySelector(".radio-group").addEventListener("change",()=>{ae(t),L()}),C.availability.checked)if(C.availability.availableCarts>0){h.innerHTML=`<p class="success"> Det er ${C.availability.availableCarts} ledige biler. Du kan n booke.</p>`;const y=document.createElement("button");y.type="submit",y.className="golfbil-btn btn-primary",y.disabled=C.isSubmitting,y.innerHTML=C.isSubmitting?'<span class="spinner"></span> Sender booking...':"Book n",t.appendChild(y)}else h.innerHTML='<p class="error"> Ingen ledige biler for valgt tidspunkt.</p>';e.appendChild(t),e.appendChild(h),n.appendChild(e)}function Va(){const n=document.createElement("div");n.className="modal-overlay",n.onclick=t=>{t.target===n&&ne()};const e=document.createElement("div");e.className="modal info-modal",e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"),e.setAttribute("aria-labelledby","info-modal-title"),e.innerHTML=`
    <div class="modal-header">
        <h2 id="info-modal-title">Informasjon om Golfbilutleie</h2>
        <button class="modal-close" aria-label="Lukk">&times;</button>
    </div>
    <div class="modal-body">
        <p>Det er 3 golfbiler som n kan leies for 9 eller 18 hull. Du betaler i Proshopen fr runden starter.</p>
        
        <h3>Bestilling kan gjres via:</h3>
        <ul>
            <li>Tlf: +47 64 88 99 42</li>
            <li>E-post: postkasse@skigk.no</li>
        </ul>

        <h3>Leiepriser</h3>
        <ul>
            <li><strong>Medlemmer:</strong> 18 hull / 9 hull  350,- / 200,-</li>
            <li><strong>Ikke-medlemmer:</strong> 18 hull / 9 hull  425,- / 250,-</li>
            <li>Kr 50,- i rabatt ved legeerklring (kopi m leveres i Proshopen).</li>
        </ul>

        <h3>Betaling og nkkel</h3>
        <p>Betaling skjer i Proshopen fr start. Du henter nkkelen til bilen der.</p>

        <h3>Retningslinjer for bruk</h3>
        <p>Ved vte forhold kan golfbiler skade banen. Det er Ski Golfklubb som avgjr om biler kan brukes. Om du ikke fr bruke bilen pga. forhold eller feil, refunderes leien.</p>

        <h4>Fr bruk</h4>
        <ul>
            <li>Koble fra ladekabel</li>
        </ul>

        <h4>Under bruk</h4>
        <ul>
            <li>Maks 2 personer per bil</li>
            <li>Hold avstand til utslag, greener og bunkere</li>
            <li>Vis hensyn til medspillere og banen</li>
        </ul>

        <h4>Etter bruk</h4>
        <ul>
            <li>Parker bilen</li>
            <li>Koble til ladekabel og lever nkkelen i Proshopen</li>
        </ul>

        <p><strong>NB!</strong> Bruk skjer p eget ansvar. Klubben kan kreve erstatning ved skade forrsaket av uvettig bruk. Ikke tillatt med frer under 18 r. Kjring i alkoholpvirket tilstand er forbudt.</p>
    </div>
  `,document.body.appendChild(n),n.appendChild(e),e.querySelector(".modal-close").addEventListener("click",ne),setTimeout(()=>n.classList.add("visible"),10)}function Fa(n){const e=document.createElement("div");e.className="modal-overlay",e.onclick=l=>{l.target===e&&ne()};const t=document.createElement("div");t.className="modal",t.setAttribute("role","dialog"),t.setAttribute("aria-modal","true"),t.setAttribute("aria-labelledby","modal-title"),t.innerHTML=`
    <div class="modal-header">
        <h2 id="modal-title">Registrer utleie for Bil ${n}</h2>
        <button class="modal-close" aria-label="Lukk">&times;</button>
    </div>
    <form id="rental-form">
        <div class="form-group">
            <label for="renterName">Navn p leietaker</label>
            <input type="text" id="renterName" name="renterName" required>
        </div>
        <div class="form-group membership-group">
             <label for="membershipNumber">Medlemsnummer</label>
             <input type="text" id="membershipNumber" name="membershipNumber" placeholder="f.eks. 73-12345" required>
        </div>
        <div class="form-group">
            <label class="checkbox-group">
                <input type="checkbox" id="hasDoctorsNote" name="hasDoctorsNote"> Legeerklring
            </label>
        </div>
        <div class="form-group">
            <label for="holes">Antall hull</label>
            <select id="holes" name="holes">
                <option value="18">18 hull</option>
                <option value="9">9 hull</option>
            </select>
        </div>
        <div class="form-group">
            <label for="paymentMethod">Betalingsform</label>
            <select id="paymentMethod" name="paymentMethod">
                ${Object.values(Ut).map(l=>`<option value="${l}">${l}</option>`).join("")}
            </select>
        </div>
        <div class="form-group">
            <label for="notes">Kommentar/notat</label>
            <textarea id="notes" name="notes"></textarea>
        </div>
        <div class="price-display"></div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="cancel-btn">Avbryt</button>
            <button type="submit" class="btn btn-primary">Bekreft utleie</button>
        </div>
    </form>
  `,document.body.appendChild(e),e.appendChild(t);const o=t.querySelector("#rental-form");o.addEventListener("submit",l=>Ba(l,n)),t.querySelector(".modal-close").addEventListener("click",ne),t.querySelector("#cancel-btn").addEventListener("click",ne);const s=()=>{const a=t.querySelector("#membershipNumber").value.trim().startsWith("73-"),u=t.querySelector("#hasDoctorsNote").checked,c=parseInt(t.querySelector("#holes").value,10),d=ce(a,u,c),f=t.querySelector(".price-display");f&&(f.textContent=`Pris: ${d},-`)};o.addEventListener("input",s),o.addEventListener("change",s),s(),setTimeout(()=>e.classList.add("visible"),10)}function ne(){const n=document.querySelector(".modal-overlay");n&&(n.classList.remove("visible"),setTimeout(()=>{n.remove()},300))}async function Ga(n){n.preventDefault();const e=n.target,o=new FormData(e).get("prompt");if(o){J.conversation.push({role:"user",text:o}),J.isLoading=!0,e.reset(),L();try{const l=`You are an AI assistant for the staff at Ski Golfklubb. Your name is 'Golfy'. 
        You have access to the current golf cart status and rental history in JSON format. 
        Answer questions based on this data. Be friendly, concise, and helpful. 
        All monetary values are in NOK. Today's date is ${new Date().toLocaleDateString("nb-NO")}.`,a={carts:k.carts,rentals:k.rentals},u=`Here is the current data: ${JSON.stringify(a)}

User question: "${o}"`,c=await Aa.models.generateContent({model:"gemini-2.5-flash",contents:u,config:{systemInstruction:l}});J.conversation.push({role:"model",text:c.text})}catch(s){console.error("Gemini API error:",s),J.conversation.push({role:"model",text:"Beklager, jeg klarte ikke  hente svar. Prv igjen."})}finally{J.isLoading=!1,L()}}}function ae(n){C.name=n.querySelector("#booking-name").value;const e=n.querySelector("#booking-membership-number").value;C.membershipNumber=e,C.isMember=e.trim().startsWith("73-"),C.hasDoctorsNote=n.querySelector("#booking-has-doctors-note").checked,C.date=n.querySelector("#booking-date").value,C.time=n.querySelector("#booking-time").value,C.holes=parseInt(n.querySelector("#booking-holes").value,10),C.notificationMethod=n.querySelector('input[name="notificationMethod"]:checked').value,C.contactInfo=n.querySelector("#contact-info").value}function ba(n){H.column===n?H.direction=H.direction==="asc"?"desc":"asc":(H.column=n,H.direction=n==="renterName"?"asc":"desc"),L()}async function Ha(n,e){if(n.preventDefault(),ae(e),C.isSubmitting=!0,L(),Gt(),await new Promise(f=>setTimeout(f,0)),C.availability.availableCarts<=0){alert("Beklager, ingen biler er ledige for dette tidspunktet. Prv et annet."),C.isSubmitting=!1,L();return}const t=new Date(`${C.date}T${C.time}`),o=ve[C.holes],s=Se[C.holes],l=new Date(t.getTime()+(o+s)*60*1e3),a=k.carts.find(f=>f.status==="out_of_order"?!1:!k.rentals.some(m=>{if(m.cartId!==f.id)return!1;const h=new Date(m.startTime),g=Ft(m);return t<g&&l>h}));if(!a){alert("Systemfeil: Kunne ikke finne en ledig bil. Prv igjen."),C.availability.checked=!1,C.isSubmitting=!1,L();return}const u={id:Date.now(),cartId:a.id,renterName:C.name,isMember:C.isMember,membershipNumber:C.membershipNumber,hasDoctorsNote:C.hasDoctorsNote,holes:C.holes,paymentMethod:null,notes:"Forhndsbooket online.",price:ce(C.isMember,C.hasDoctorsNote,C.holes),startTime:t.toISOString(),endTime:null,notificationMethod:C.notificationMethod,contactInfo:C.contactInfo,reminderSent:!1},c=`Hei ${u.renterName}. Din booking av golfbil #${u.cartId} hos Ski GK er bekreftet for ${z(u.startTime)}. Velkommen!`;await Vt(u.notificationMethod,u.contactInfo,c)?(k.rentals.push(u),se(),alert(`Takk, ${C.name}! Din booking er bekreftet. En bekreftelse er sendt til ${C.contactInfo}.`),C.availability.checked=!1,C.isSubmitting=!1,qt&&(Z="dashboard"),L()):(alert("En feil oppstod under sending av varsel. Bookingen ble ikke fullfrt. Vennligst prv igjen."),C.isSubmitting=!1,L())}function Ba(n,e){n.preventDefault();const t=n.target,o=new FormData(t),s=o.get("membershipNumber"),l=s.trim().startsWith("73-"),a={id:Date.now(),cartId:e,renterName:o.get("renterName"),isMember:l,membershipNumber:s,hasDoctorsNote:!!o.get("hasDoctorsNote"),holes:parseInt(o.get("holes"),10),paymentMethod:o.get("paymentMethod"),notes:o.get("notes"),price:0,startTime:new Date().toISOString(),endTime:null,notificationMethod:null,contactInfo:null,reminderSent:!0};a.price=ce(a.isMember,a.hasDoctorsNote,a.holes),k.rentals.push(a);const u=k.carts.find(c=>c.id===e);u.status="rented",u.currentRentalId=a.id,se(),ne(),L()}function Ja(n){const e=k.carts.find(o=>o.id===n),t=k.rentals.find(o=>o.id===e.currentRentalId);t&&(t.endTime=new Date().toISOString()),e.status="available",e.currentRentalId=null,se(),L()}function $a(n){const e=k.carts.find(t=>t.id===n);if(e.status==="rented"){const t=k.rentals.find(o=>o.id===e.currentRentalId);t&&(t.endTime=new Date().toISOString(),t.notes||(t.notes=""),t.notes+=`
(Bil satt ute av drift under leie)`)}e.status="out_of_order",e.currentRentalId=null,se(),L()}function Ya(n){const e=k.carts.find(t=>t.id===n);e.status="available",e.currentRentalId=null,se(),L()}async function Ka(n){const e=k.rentals.find(s=>s.id===n);if(!e||!e.contactInfo||!e.notificationMethod)return;const t=`Pminnelse: Du har en golfbil-booking hos Ski GK i dag kl. ${new Date(e.startTime).toLocaleTimeString("nb-NO",{timeStyle:"short"})}. Velkommen!`;await Vt(e.notificationMethod,e.contactInfo,t)?(e.reminderSent=!0,se(),L()):alert("Kunne ikke sende pminnelse.")}function Wa(){const n=["Bil ID","Leietaker","Medlem","Medlemsnr.","Legeerklring","Antall Hull","Betalingsmetode","Pris","Starttid","Returtid","Notater"],e=k.rentals.map(a=>[a.cartId,`"${a.renterName.replace(/"/g,'""')}"`,a.isMember?"Ja":"Nei",a.membershipNumber||"N/A",a.hasDoctorsNote?"Ja":"Nei",a.holes,a.paymentMethod||"N/A",a.price!==null?a.price:"N/A",z(a.startTime),a.endTime?z(a.endTime):"N/A",`"${a.notes.replace(/"/g,'""')}"`]),t="data:text/csv;charset=utf-8,"+n.join(",")+`
`+e.map(a=>a.join(",")).join(`
`),o=encodeURI(t),s=document.createElement("a");s.setAttribute("href",o);const l=new Date().toISOString().slice(0,10);s.setAttribute("download",`golfbil_logg_${l}.csv`),document.body.appendChild(s),s.click(),document.body.removeChild(s)}document.addEventListener("DOMContentLoaded",L);
